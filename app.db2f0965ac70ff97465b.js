var app=function(e){function t(t){for(var s,i,n=t[0],o=t[1],a=0,h=[];a<n.length;a++)i=n[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&h.push(r[i][0]),r[i]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);for(c&&c(t);h.length;)h.shift()()}var s={},r={0:0};function i(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],s=r[e];if(0!==s)if(s)t.push(s[2]);else{var n=new Promise(function(t,i){s=r[e]=[t,i]});t.push(s[2]=n);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+""+({}[e]||e)+".db2f0965ac70ff97465b.js"}(e);var c=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(h);var s=r[e];if(0!==s){if(s){var i=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+n+")",c.name="ChunkLoadError",c.type=i,c.request=n,s[1](c)}r[e]=void 0}};var h=setTimeout(function(){o({type:"timeout",target:a})},12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=s,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var n=window.webpackJsonp_name_=window.webpackJsonp_name_||[],o=n.push.bind(n);n.push=t,n=n.slice();for(var a=0;a<n.length;a++)t(n[a]);var c=o;return i(i.s=0)}([function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(149),n=s(150),o=s(230),a=s(248),c=s(225);function h(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),r.forEach(function(t){u(e,t,s[t])})}return e}function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const l={mainConfig:i,processorsPlugins:h({},r.contribProcessorsPlugins,n.default),components:h({},r.contribComponents,o.default),pluginHelpers:h({},a.default)};new r.Engine(l).start(),console.log("Hello! You can contact the author via email: mikhail.remmele@gmail.com"),Object(c.isIosSafari)()?Object(c.applyIosSafariScreenFix)():Object(c.isIos)()&&Object(c.applyIosChromeScreenFix)()},function(e,t,s){"use strict";s.r(t);var r=s(2);s.d(t,"Engine",function(){return r.default});var i=s(30);s.d(t,"Processor",function(){return i.default});var n=s(31);s.d(t,"ProcessorPlugin",function(){return n.default});var o=s(32);s.d(t,"Component",function(){return o.default});var a=s(33);s.d(t,"Script",function(){return a.default});var c=s(34);s.d(t,"contribProcessorsPlugins",function(){return c.default});var h=s(120);s.d(t,"contribComponents",function(){return h.default});var u=s(5);s.d(t,"IOC",function(){return u.default});var l=s(46);s.d(t,"VectorOps",function(){return l.VectorOps}),s.d(t,"MathOps",function(){return l.MathOps}),s.d(t,"Vector2",function(){return l.Vector2});var d=s(10);s.d(t,"RESOURCES_LOADER_KEY_NAME",function(){return d.RESOURCES_LOADER_KEY_NAME}),s.d(t,"PROJECT_SETTINGS_KEY_NAME",function(){return d.PROJECT_SETTINGS_KEY_NAME})},function(e,t,s){"use strict";s.r(t);var r=s(3),i=s(5),n=s(7),o=s(8),a=s(16),c=s(22),h=s(26),u=s(28),l=s(10);t.default=class{constructor(e){const{GENERAL_SCOPE_NAME:t}=l;this.options=e,r.default.createScope(t),r.default.setCurrentScope(t)}async start(){const{SCENE_PROVIDER_KEY_NAME:e,RESOURCES_LOADER_KEY_NAME:t,PREFAB_COLLECTION_KEY_NAME:s,PROJECT_SETTINGS_KEY_NAME:r,GAME_OBJECT_CREATOR_KEY_NAME:d}=l,{mainConfig:_,processorsPlugins:g,components:f,pluginHelpers:p}=this.options,{projectSettings:m}=_;i.default.register(r,new n.default(m));const b=new a.default;i.default.register(t,new n.default(b));const v=new h.default(f);i.default.register(s,new n.default(v));const O=new c.default(f);i.default.register(d,new n.default(O));const y=new o.default(_.scenes,g,p);i.default.register(e,new n.default(y));for(let e=0;e<_.prefabs.length;e++){const t=await b.load(_.prefabs[e].src);v.register(t)}await y.loadScene(_.startScene),y.moveToLoaded();const E=new u.default;E.run(),window.onblur=(()=>E.stop()),window.onfocus=(()=>E.run())}}},function(e,t,s){"use strict";s.r(t);var r=s(4);const i=new class{constructor(){return this.instance||(this.instance=this,this.scopes={},this.currentScopeName=void 0,this.scopeChangeSubscribers=[]),this.instance}createScope(e){this.scopes[e]=new r.default}removeScope(e){this.scopes[e]=void 0}setCurrentScope(e){if(!this.scopes[e])throw new Error(`Error while setting new scope. Not found scope with same name: ${e}`);this.currentScopeName=e,this.scopeChangeSubscribers.forEach(e=>{e(this.scopes[this.currentScopeName])})}getCurrentScope(){if(!this.currentScopeName)throw new Error("Current scope is null");return this.scopes[this.currentScopeName]}subscribeOnScopeChange(e){if(!(e instanceof Function))throw new Error("On subscribe callback should be a function");this.scopeChangeSubscribers.push(e)}};Object.seal(i),t.default=i},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(){this.storage={}}resolve(e,t){if(!this.storage[e])throw new Error(`Resolution of dependency failed for key: ${e}`);return this.storage[e].resolve(t)}register(e,t){this.storage[e]=t}remove(e){this.storage[e]=void 0}}},function(e,t,s){"use strict";s.r(t);var r=s(3),i=s(6);const n=new class{constructor(){return this.instance||(this.instance=this),this.instance}resolve(e,...t){return r.default.getCurrentScope().resolve(e,t)}register(e,t){if(!(t instanceof i.default))throw new Error("Resolve dependency strategy should be inherits from ResolveDependencyStrategy");r.default.getCurrentScope().register(e,t)}remove(e){r.default.getCurrentScope().remove(e)}};Object.freeze(n),t.default=n},function(e,t,s){"use strict";s.r(t);t.default=class{resolve(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(6);t.default=class extends r.default{constructor(e){super(),this.instance=e}resolve(){return this.instance}}},function(e,t,s){"use strict";s.r(t);var r=s(5),i=s(9),n=s(14),o=s(15),a=s(10);t.default=class{constructor(e,t,s){this._sceneContainer={},this._currentSceneName=void 0,this._sceneChangeSubscribers=[],this._availableScenes=e,this._processorsPlugins=Object.keys(t).reduce((e,s)=>{const r=t[s];return e[s]=new r,e},{}),this._pluginHelpers=s,this._loadedScene=null,this._sceneController=new o.default(this)}async loadScene(e){if(!this._availableScenes[e])throw new Error(`Error while loading the scene. Not found scene with same name: ${e}`);this._loadedScene=void 0;const t=r.default.resolve(a.RESOURCES_LOADER_KEY_NAME),s=await t.load(this._availableScenes[e]),o=new i.default({name:s.name,gameObjects:s.gameObjects});for(let e=0;e<s.processors.length;e++){const{name:t,filter:r,options:i,section:a}=s.processors[e],c=new n.default(o,r),h=await this._processorsPlugins[t].load({...i,store:o.getStore(),gameObjectSpawner:o.getGameObjectSpawner(),gameObjectDestroyer:o.getGameObjectDestroyer(),gameObjectObserver:c,sceneController:this._sceneController,helpers:this._pluginHelpers});o.addProcessor(h,a)}this._loadedScene=o}isLoaded(){return!!this._loadedScene}moveToLoaded(){if(!this._loadedScene)return;this._sceneContainer[this._currentSceneName]&&this.leaveCurrentScene();const e=this._loadedScene.getName();this._sceneContainer[e]=this._loadedScene,this._loadedScene=void 0,this.setCurrentScene(e)}leaveCurrentScene(){if(!this._sceneContainer[this._currentSceneName])throw new Error("Error while leaving current scene. Current scene is null");this._sceneContainer[this._currentSceneName].unmount(),this._currentSceneName=void 0}removeScene(e){e===this._currentSceneName&&this.leaveCurrentScene(),this._sceneContainer[e]=void 0}setCurrentScene(e){if(!this._sceneContainer[e])throw new Error(`Error while setting new scene. Not found scene with same name: ${e}`);this._sceneContainer[this._currentSceneName]&&this._sceneContainer[this._currentSceneName].unmount(),this._currentSceneName=e,this._sceneContainer[this._currentSceneName].mount(),this._sceneChangeSubscribers.forEach(e=>{e(this._sceneContainer[this._currentSceneName])})}getCurrentScene(){if(!this._currentSceneName)throw new Error("Current scene is null");return this._sceneContainer[this._currentSceneName]}subscribeOnSceneChange(e){if(!(e instanceof Function))throw new Error("On subscribe callback should be a function");this._sceneChangeSubscribers.push(e)}}},function(e,t,s){"use strict";s.r(t);var r=s(10),i=s(5),n=s(11),o=s(12),a=s(13);const c="GAME_OBJECT_ADDED",h="GAME_OBJECT_REMOVED";t.default=class{constructor(e){const{name:t,gameObjects:s}=e;this._name=t,this._gameObjects={},this._store=new n.default,this._gameObjectCreator=i.default.resolve(r.GAME_OBJECT_CREATOR_KEY_NAME),this._gameObjectSpawner=new o.default(this,this._gameObjectCreator),this._gameObjectDestroyer=new a.default(this),this._processorSections={[r.SECTIONS.EVENT_PROCESS_SECTION_NAME]:[],[r.SECTIONS.GAME_STATE_UPDATE_SECTION_NAME]:[],[r.SECTIONS.RENDERING_SECTION_NAME]:[]},this._gameObjectsChangeSubscribers=[],this.GAME_OBJECT_ADDED=c,this.GAME_OBJECT_REMOVED=h,s.forEach(e=>{this._gameObjectCreator.create(e).forEach(e=>{this.addGameObject(e)})})}mount(){Object.keys(this._processorSections).forEach(e=>{this._processorSections[e].forEach(e=>{e.processorDidMount()})})}unmount(){Object.keys(this._processorSections).forEach(e=>{this._processorSections[e].forEach(e=>{e.processorWillUnmount()})})}addProcessor(e,t){this._processorSections[t].push(e)}getProcessorSection(e){return this._processorSections[e]}getStore(){return this._store}getGameObjectSpawner(){return this._gameObjectSpawner}getGameObjectDestroyer(){return this._gameObjectDestroyer}addGameObject(e){const t=e.getId();if(this._gameObjects[t])throw new Error(`The game object with same id already exists: ${t}`);this._gameObjects[t]=e,this._gameObjectsChangeSubscribers.forEach(t=>{t({type:c,gameObject:e})})}removeGameObject(e){e.clearSubscriptions(),this._gameObjects[e.getId()]=void 0,this._gameObjectsChangeSubscribers.forEach(t=>{t({type:h,gameObject:e})})}getName(){return this._name}getGameObjects(){return Object.values(this._gameObjects)}subscribeOnGameObjectsChange(e){if(!(e instanceof Function))throw new Error("On subscribe callback should be a function");this._gameObjectsChangeSubscribers.push(e)}}},function(e,t,s){"use strict";s.r(t),s.d(t,"GENERAL_SCOPE_NAME",function(){return r}),s.d(t,"PREFAB_COLLECTION_KEY_NAME",function(){return i}),s.d(t,"GAME_OBJECT_CREATOR_KEY_NAME",function(){return n}),s.d(t,"SCENE_PROVIDER_KEY_NAME",function(){return o}),s.d(t,"RESOURCES_LOADER_KEY_NAME",function(){return a}),s.d(t,"PROJECT_SETTINGS_KEY_NAME",function(){return c}),s.d(t,"SECTIONS",function(){return h});const r="general",i="prefabCollection",n="gameObjectCreator",o="sceneProvider",a="resourcesLoader",c="projectSettings",h={EVENT_PROCESS_SECTION_NAME:"eventProcessSection",GAME_STATE_UPDATE_SECTION_NAME:"gameStateUpdateSection",RENDERING_SECTION_NAME:"renderingSection"}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(){this._store={}}set(e,t){this._store[e]=t}get(e){return this._store[e]}has(e){return!!this._store[e]}delete(e){const t=this.has(e);return this._store[e]=void 0,t}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e,t){this._scene=e,this._gameObjectCreator=t}spawn(e){const t=this._gameObjectCreator.create({prefabName:e,fromPrefab:!0,isNew:!0});return t.forEach(e=>{this._scene.addGameObject(e)}),t[0]}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e){this._scene=e}_deleteFromScene(e){this._scene.removeGameObject(e),e.getChildren().forEach(e=>{this._deleteFromScene(e)})}destroy(e){e.parent&&e.parent.removeChild(e),this._deleteFromScene(e)}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e,t){const{type:s,components:r=[]}=t;this._components=r,this._type=s,this._observedGameObjects=e.getGameObjects(),this._addedToAccepted=[],this._removedFromAccepted=[],this._acceptedGameObjectsMap={},this._acceptedGameObjects=this._observedGameObjects.filter(e=>(e.subscribe(this._subscribeGameObject.bind(this)),!!this._test(e)&&(this._acceptedGameObjectsMap[e.getId()]=e,this._addedToAccepted.push(e),!0))),e.subscribeOnGameObjectsChange(t=>{const s=t.gameObject;e.GAME_OBJECT_ADDED===t.type?(s.subscribe(this._subscribeGameObject.bind(this)),this._add(s)):this._remove(s)})}_subscribeGameObject(e){const t=e.gameObject;this._test(t)?this._accept(t):this._decline(t)}_add(e){this._observedGameObjects.push(e),this._test(e)&&this._accept(e)}_remove(e){const t=e=>e.filter(e=>s!==e.getId()),s=e.getId();this._observedGameObjects=t(this._observedGameObjects),this._acceptedGameObjects=t(this._acceptedGameObjects),this._acceptedGameObjectsMap[s]=void 0,this._removedFromAccepted.push(e)}_test(e){const t=e.getType();return(!this._type||this._type===t)&&this._components.every(t=>e.getComponent(t))}_accept(e){const t=e.getId();this._acceptedGameObjectsMap[t]||(this._acceptedGameObjects.push(e),this._acceptedGameObjectsMap[t]=e,this._addedToAccepted.push(e))}_decline(e){const t=e.getId();this._acceptedGameObjectsMap[t]&&(this._acceptedGameObjects=this._acceptedGameObjects.filter(e=>t!==e.getId()),this._acceptedGameObjectsMap[t]=void 0,this._removedFromAccepted.push(e))}size(){return this._acceptedGameObjects.length}getLastRemoved(){const e=this._removedFromAccepted;return this._removedFromAccepted=[],e}getLastAdded(){const e=this._addedToAccepted;return this._addedToAccepted=[],e}getById(e){return this._acceptedGameObjectsMap[e]}getByIndex(e){return this._acceptedGameObjects[e]}forEach(e){this._acceptedGameObjects.forEach(e)}map(e){return this._acceptedGameObjects.map(e)}sort(e){this._acceptedGameObjects=this._acceptedGameObjects.sort(e)}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e){this._sceneProvider=e}getCurrentName(){return this._sceneProvider.getCurrentScene().getName()}load(e){this._sceneProvider.loadScene(e)}isLoaded(){return this._sceneProvider.isLoaded()}moveToLoaded(){this._sceneProvider.moveToLoaded()}moveTo(e){this._sceneProvider.setCurrentScene(e)}}},function(e,t,s){"use strict";s.r(t);var r=s(17);t.default=class{constructor(){this.resourceLoaderQualifier=new r.default}load(e){return this.resourceLoaderQualifier.getLoader(e).load(e)}}},function(e,t,s){"use strict";s.r(t);var r=s(18);const i=".";t.default=class{constructor(){this.loaders=Object.keys(r.default).map(e=>new(0,r.default[e]))}_getResourceExt(e){return`${i}${e.split(i).pop()}`}getLoader(e){const t=this._getResourceExt(e);return this.loaders.find(e=>e.getSupportedExtensions().includes(t))}}},function(e,t,s){"use strict";s.r(t);var r=s(19),i=s(21);t.default={imageLoader:r.default,jsonLoader:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(20);t.default=class extends r.default{constructor(){super(),this._supportedExtensions=[".png"]}getSupportedExtensions(){return this._supportedExtensions}load(e){return new Promise((t,s)=>{const r=new Image;r.src=e,r.onload=(()=>{t(r)}),r.onerror=(()=>{s(new Error("Failed to load image"))})})}}},function(e,t,s){"use strict";s.r(t);t.default=class{getSupportedExtensions(){throw new Error("You should override this function")}load(){Promise.reject(new Error("You should override this function"))}}},function(e,t,s){"use strict";s.r(t);var r=s(20);t.default=class extends r.default{constructor(){super(),this._supportedExtensions=[".json"]}getSupportedExtensions(){return this._supportedExtensions}load(e){return fetch(e).then(e=>e.json()).catch(e=>new Error(`Failed to load json: ${e.message}`))}}},function(e,t,s){"use strict";s.r(t);var r=s(23),i=s.n(r),n=s(5),o=s(25),a=s(10);t.default=class{constructor(e){this._components=e,this._prefabCollection=n.default.resolve(a.PREFAB_COLLECTION_KEY_NAME)}_buildFromPrefab(e,t){const{type:s,prefabName:r,components:n=[],children:a=[],isNew:c=!1}=e;let{id:h,name:u}=e;if(h=h||i()(),u=u||h,!t)throw new Error(`Can't create game object ${u} from prefab. `+`The prefab ${r} is null.`);const l=new o.default(h);if(l.setType(s||t.getType()),c)t.getChildren().forEach(e=>{const{name:t}=e,s={prefabName:t,fromPrefab:!0,isNew:c},r=this._build(s,e);l.appendChild(r)});else{const e=t.getChildren().reduce((e,t)=>(e[t.getName()]=t,e),{});a.forEach(t=>{const{prefabName:s,fromPrefab:r}=t,i=r?e[s]:void 0,n=this._build(t,i);l.appendChild(n)})}return t.getAvailableComponents().forEach(e=>{l.setComponent(e,t.getComponent(e))}),n.forEach(e=>{const t=this._components[e.name];l.setComponent(e.name,new t(e.name,e.config))}),l}_buildFromScratch(e){const{type:t,components:s=[],children:r=[]}=e;let{id:n}=e;n=n||i()();const a=new o.default(n);return a.setType(t),r.forEach(e=>{const t=this._build(e);a.appendChild(t)}),s.forEach(e=>{const t=this._components[e.name];a.setComponent(e.name,new t(e.name,e.config))}),a}_build(e,t){const{prefabName:s,fromPrefab:r}=e;return r?(t=t||this._prefabCollection.get(s),this._buildFromPrefab(e,t)):this._buildFromScratch(e)}_expandGameObject(e,t){return(t=t||[]).push(e),e.getChildren().forEach(e=>{this._expandGameObject(e,t)}),t}create(e){return this._expandGameObject(this._build(e))}}},function(e,t,s){"use strict";!function(){var t,r,i,n=0,o=[];for(h.BUFFER_SIZE=512,h.bin=c,h.test=function(e){if("string"==typeof e)return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(e)},r=0;r<256;r++)o[r]=(r+256).toString(16).substr(1);function a(e,t){return Math.floor(Math.random()*(t-e))+e}function c(){var e=function(e){var s;if(void 0!==i){if(void 0===t||n+e>h.BUFFER_SIZE)if(n=0,i.getRandomValues)t=new Uint8Array(h.BUFFER_SIZE),i.getRandomValues(t);else{if(!i.randomBytes)throw new Error("Non-standard crypto library");t=i.randomBytes(h.BUFFER_SIZE)}return t.slice(n,n+=e)}for(s=[],r=0;r<e;r++)s.push(a(0,255));return s}(16);return e[6]=15&e[6]|64,e[8]=63&e[8]|128,e}function h(){var e=c();return o[e[0]]+o[e[1]]+o[e[2]]+o[e[3]]+"-"+o[e[4]]+o[e[5]]+"-"+o[e[6]]+o[e[7]]+"-"+o[e[8]]+o[e[9]]+"-"+o[e[10]]+o[e[11]]+o[e[12]]+o[e[13]]+o[e[14]]+o[e[15]]}"undefined"!=typeof crypto?i=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(i=window.msCrypto),i=i||s(24),e.exports=h}()},function(e,t){},function(e,t,s){"use strict";s.r(t);const r="COMPONENT_ADDED",i="COMPONENT_REMOVED";t.default=class{constructor(e){this._id=e,this._components={},this._parent=null,this._children=[],this._type=null,this._subscribers=[],this.COMPONENT_ADDED=r,this.COMPONENT_REMOVED=i}set parent(e){this._parent=e}get parent(){return this._parent}getAncestor(){const e=t=>t.parent?e(t.parent):t;return e(this)}appendChild(e){this._children.push(e),e.parent=this}removeChild(e){this._children=this._children.filter(t=>t.getId()!==e.getId()),e.parent=void 0}getChildren(){return this._children}getId(){return this._id}getComponentNamesList(){return Object.keys(this._components)}getComponent(e){return this._components[e]}setComponent(e,t){this._components[e]=t,t.gameObject=this,this._subscribers.forEach(t=>{t({type:r,componentName:e,gameObject:this})})}removeComponent(e){this._components[e]&&(this._components[e].gameObject=void 0,this._components=Object.keys(this._components).reduce((t,s)=>(s!==e&&(t[s]=this._components[s]),t),{}),this._subscribers.forEach(t=>{t({type:i,componentName:e,gameObject:this})}))}getType(){return this._type}setType(e){this._type=e}subscribe(e){if(!(e instanceof Function))throw new Error("On subscribe callback should be a function");this._subscribers.push(e)}clearSubscriptions(){this._subscribers=[]}}},function(e,t,s){"use strict";s.r(t);var r=s(27);t.default=class{constructor(e){this._components=e,this._storage={}}_buildPrefab(e){const{name:t,type:s,components:i=[],children:n=[]}=e,o=new r.default;return o.setName(t),o.setType(s),n.forEach(e=>{const t=this._buildPrefab(e);t.setParent(o),o.appendChild(t)}),i.forEach(e=>{const t=this._components[e.name];o.setComponent(e.name,new t(e.name,e.config))}),o}register(e){this._storage[e.name]=this._buildPrefab(e)}get(e){if(!this._storage[e])throw new Error(`Can't find prefab with same name: ${e}`);return this._storage[e].clone()}}},function(e,t,s){"use strict";s.r(t);class r{constructor(){this._name=null,this._components={},this._parent=null,this._children=[],this._type=null}setName(e){this._name=e}getName(){return this._name}setParent(e){this._parent=e}getParent(){return this._parent}appendChild(e){this._children.push(e)}getChildren(){return this._children}setComponent(e,t){this._components[e]=t}getComponent(e){if(!this._components[e])throw new Error(`Can't find component with the following name: ${e}`);return this._components[e]}getAvailableComponents(){return Object.keys(this._components)}setType(e){this._type=e}getType(){return this._type}clone(){const e=new r;return e.setName(this._name),e.setType(this._type),this._children.forEach(t=>{const s=t.clone();s.setParent(e),e.appendChild(s)}),Object.keys(this._components).forEach(t=>{e.setComponent(t,this._components[t].clone())}),e}}t.default=r},function(e,t,s){"use strict";s.r(t);var r=s(5),i=s(29),n=s(10);const o=1e3/60;t.default=class{constructor(){this.gameLoopId=null,this.sceneProvider=r.default.resolve(n.SCENE_PROVIDER_KEY_NAME),this.messageBus=new i.default}_processSection(e,t){const s=this.sceneProvider.getCurrentScene().getProcessorSection(e);t={...t||{},messageBus:this.messageBus},s.forEach(e=>{e.process(t)})}_gameStateUpdate(){if(this.lag<o)this.messageBus.stash();else{for(;this.lag>=o;)this._processSection(n.SECTIONS.GAME_STATE_UPDATE_SECTION_NAME,{deltaTime:o}),this.lag-=o,this.lag>=o&&(this.messageBus.stash(),this.messageBus.sendDelayed());this.messageBus.restore()}}run(){this.previous=void 0,this.lag=o;const e=this;this.gameLoopId=requestAnimationFrame(function t(s){e.previous=e.previous||s;const r=s-e.previous;e.previous=s,e.lag+=r,e.messageBus.restore(),e.messageBus.sendDelayed(),e._processSection(n.SECTIONS.EVENT_PROCESS_SECTION_NAME),e._gameStateUpdate(),e._processSection(n.SECTIONS.RENDERING_SECTION_NAME,{deltaTime:r}),e.messageBus.clear(),e.gameLoopId=requestAnimationFrame(t)})}stop(){this.gameLoopId&&cancelAnimationFrame(this.gameLoopId)}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(){this._messages={},this._stashedMessages=[],this._delayedMessages=[]}send(e,t=!1){if(!e.type)throw new Error("Can't send the message without specified type");if(t)return void this._delayedMessages.push(e);const{type:s,id:r}=e;this._messages[s]=this._messages[s]||{array:[],map:{}},r&&(this._messages[s].map[r]=this._messages[s].map[r]||[],this._messages[s].map[r].push(e)),this._messages[s].array.push(e)}get(e){return this._messages[e]?this._messages[e].array:void 0}getById(e,t){return this._messages[e]?this._messages[e].map[t]:void 0}getMessageCount(){return Object.keys(this._messages).reduce((e,t)=>this._messages[t]?e+this._messages[t].array.length:e,0)}delete(e){this._messages[e]=void 0}deleteById(e,t){const s=this.getById(e,t);s&&(this._messages[e].array=this._messages[e].array.filter(e=>!s.includes(e)),this._messages[e].map[t]=void 0)}stash(){this._stashedMessages.push(this._messages),this._messages={}}restore(){0!==this._stashedMessages.length&&(this._stashedMessages.push(this._messages),this._messages=this._stashedMessages.reduce((e,t)=>(Object.keys(t).forEach(s=>{t[s]&&(e[s]=e[s]||{array:[],map:{}},e[s].array=e[s].array.concat(t[s].array),e[s].map=Object.keys(t[s].map).reduce((e,r)=>(e[r]?e[r]=e[r].concat(t[s].map[r]):e[r]=t[s].map[r],e),e[s].map))}),e),{}),this._stashedMessages=[])}sendDelayed(){this._delayedMessages.length&&(this._delayedMessages.forEach(e=>{this.send(e)}),this._delayedMessages=[])}clear(){this._messages={}}reset(){this._messages={},this._stashedMessages=[],this._delayedMessages=[]}}},function(e,t,s){"use strict";s.r(t);t.default=class{processorDidMount(){}processorWillUnmount(){}process(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);t.default=class{async load(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);const r=(e,t)=>{if(!e.parent)return;const s=e.parent.getComponent(t);return s||r(e.parent,t)};t.default=class{constructor(e){this._componentName=e}set componentName(e){this._componentName=e}get componentName(){return this._componentName}set gameObject(e){this._gameObject=e}get gameObject(){return this._gameObject}getParentComponent(){if(this.gameObject)return r(this.gameObject,this.componentName)}clone(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e,t,s,r){this.gameObject=e,this.store=t,this.spawner=s,this.destroyer=r}update(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(35),i=s(50),n=s(52),o=s(55),a=s(72),c=s(74),h=s(76),u=s(78),l=s(80),d=s(85),_=s(87),g=s(89),f=s(92),p=s(94),m=s(96),b=s(112),v=s(114),O=s(116);t.default={animateProcessor:r.default,cameraProcessor:i.default,collisionBroadcastProcessor:n.default,collisionDetectionProcessor:o.default,collisionSolver:a.default,constraintSolver:c.default,gameStatsMeter:h.GameStatsMeterPlugin,jammer:u.default,keyboardInputProcessor:l.default,keyboardControlProcessor:d.default,mouseControlProcessor:_.default,mouseInputProcessor:g.default,mouseInputCoordinatesProjector:f.default,physicsProcessor:p.default,renderProcessor:m.default,sceneLoadProcessor:b.default,scriptProcessor:v.default,uiBridge:O.default}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(36);t.default=class extends r.default{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(37),n=s(42);const o=100,a="renderable",c="animatable";t.default=class extends r.default{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._conditionControllers=Object.keys(i.default).reduce((e,t)=>{const s=i.default[t];return e[t]=new s,e},{}),this._substatePickers=Object.keys(n.default).reduce((e,t)=>{const s=n.default[t];return e[t]=new s,e},{})}_setFrame(e,t){e.currentFrame=t.index,e.rotation=void 0!==t.rotation?t.rotation:e.rotation,e.flipX=void 0!==t.flipX?t.flipX:e.flipX,e.flipY=void 0!==t.flipY?t.flipY:e.flipY,e.disabled=t.disabled}_pickSubstate(e,t){return this._substatePickers[t.pickMode].getSubstate(e,t.substates,t.pickProps)}process(e){const t=e.deltaTime,s=e.messageBus;this._gameObjectObserver.forEach(e=>{const r=e.getComponent(a),i=e.getComponent(c);let n=i.currentState.timeline;i.currentState.substates&&(n=this._pickSubstate(e,i.currentState).timeline);const h=n.frames.length,u=h*(o/i.currentState.speed);i.duration+=t/u;const l=i.duration<1||n.looped?Math.trunc(i.duration%1*h):h-1;this._setFrame(r,n.frames[l]);const d=i.currentState.transitions.find(t=>!(t.time&&i.duration<t.time)&&t.conditions.every(t=>this._conditionControllers[t.type].check(t.props,e,s)));d&&(i.currentState=d.state,i.duration=0)})}}},function(e,t,s){"use strict";s.r(t);var r=s(38),i=s(40);t.default={message:r.default,comparator:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(39);t.default=class extends r.default{check(e,t,s){const{message:r}=e;return(s.get(r)||[]).some(e=>e.gameObject.getId()===t.getId())}}},function(e,t,s){"use strict";s.r(t);t.default=class{check(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(39),i=s(41);t.default=class extends r.default{constructor(){super(),this._getters={number:e=>{if("number"!=typeof e)throw new Error("The value must be a number");return e},componentValue:i.getComponentValue},this._operations={equals:(e,t)=>e===t,notEquals:(e,t)=>e!==t,greater:(e,t)=>e>t,less:(e,t)=>e<t,greaterOrEqual:(e,t)=>e>=t,lessOrEqual:(e,t)=>e<=t}}_getValue(e,t){if(!this._getters[e.type])throw new Error(`Unknown value type: ${e.type}`);return this._getters[e.type](e.value,t)}check(e,t){const{operation:s}=e;if(!this._operations[s])throw new Error(`Unknown operation type: ${s}`);const r=this._getValue(e.arg1,t),i=this._getValue(e.arg2,t);return this._operations[s](r,i)}}},function(e,t,s){"use strict";s.r(t),s.d(t,"getComponentValue",function(){return r});const r=(e,t)=>{const s=e[0];let r=t.getComponent(s);for(let t=1;t<e.length&&void 0!==r;t++)r=r[e[t]];return r}},function(e,t,s){"use strict";s.r(t);var r=s(43),i=s(45);t.default={"1D":r.default,"2D":i.default}},function(e,t,s){"use strict";s.r(t);var r=s(44),i=s(41);t.default=class extends r.default{_getDistance(e,t){return Math.abs(e-t)}getSubstate(e,t,s){if(!t.length)return;if(1===t.length)return t[0];const r=Object(i.getComponentValue)(s.x,e);let n=t[0],o=this._getDistance(r,n.x);for(let e=1;e<t.length;e++){const s=this._getDistance(r,t[e].x);s<o&&(n=t[e],o=s)}return n}}},function(e,t,s){"use strict";s.r(t);t.default=class{getSubstate(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(46),i=s(44),n=s(41);t.default=class extends i.default{_getDistance(e,t,s,i){return r.MathOps.getDistanceBetweenTwoPoints(e,t,s,i)}getSubstate(e,t,s){if(!t.length)return;if(1===t.length)return t[0];const r=Object(n.getComponentValue)(s.x,e),i=Object(n.getComponentValue)(s.y,e);let o=t[0],a=this._getDistance(r,o.x,i,o.y);for(let e=1;e<t.length;e++){const s=this._getDistance(r,t[e].x,i,t[e].y);s<a&&(o=t[e],a=s)}return o}}},function(e,t,s){"use strict";s.r(t);var r=s(47);s.d(t,"Vector2",function(){return r.Vector2});var i=s(48);s.d(t,"VectorOps",function(){return i.VectorOps});var n=s(49);s.d(t,"MathOps",function(){return n.MathOps})},function(e,t,s){"use strict";s.r(t),s.d(t,"Vector2",function(){return r});class r{constructor(e,t){this._x=e,this._y=t}set x(e){this._x=e}get x(){return this._x}set y(e){this._y=e}get y(){return this._y}get magnitude(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}add(e){this._x+=e.x,this._y+=e.y}multiplyNumber(e){this._x*=e,this._y*=e}equals(e){return this._x===e.x&&this._y===e.y}clone(){return new r(this._x,this._y)}}},function(e,t,s){"use strict";s.r(t),s.d(t,"VectorOps",function(){return i});var r=s(47);class i{static fixCalcError(e){return Math.abs(e)<Number.EPSILON?0:e}static getVectorByAngle(e){const t=this.fixCalcError(Math.cos(e)),s=this.fixCalcError(Math.sin(e));return new r.Vector2(t,s)}static getNormal(e,t,s,i){const n=new r.Vector2(s-i,t-e);return n.multiplyNumber(1/n.magnitude),n}static dotProduct(e,t){return e.x*t.x+e.y*t.y}}},function(e,t,s){"use strict";s.r(t),s.d(t,"MathOps",function(){return r});class r{static random(e,t){return Math.floor(e+Math.random()*(t+1-e))}static radToDeg(e){const t=180*e/Math.PI;return t<0?t+360:t}static degToRad(e){return e*Math.PI/180}static getAngleBetweenTwoPoints(e,t,s,r){return Math.atan2(s-r,e-t)}static getDistanceBetweenTwoPoints(e,t,s,r){return Math.sqrt(Math.pow(t-e,2)+Math.pow(r-s,2))}static getLinePoint(e,t,s,r){const i=this.degToRad(e);return{x:t-r*Math.cos(i),y:s-r*Math.sin(i)}}static clamp(e,t,s){return e<t?t:e>s?s:e}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(51);t.default=class extends r.default{async load(e){const{initialCamera:t,windowNodeId:s,gameObjectObserver:r,store:n}=e,o=document.getElementById(s);return new i.default({initialCamera:t,window:o,gameObjectObserver:r,store:n})}}},function(e,t,s){"use strict";s.r(t);var r=s(30);const i="currentCamera",n="SET_CAMERA",o="camera";t.default=class extends r.default{constructor(e){super();const{store:t,gameObjectObserver:s,window:r,initialCamera:i}=e;this._gameObjectObserver=s,this._store=t,this._window=r;const n=this._gameObjectObserver.getById(i);if(!n)throw new Error(`Could not set camera with id ${i} for the scene`);this._setCamera(n)}_updateCameraWindowSize(e){const t=e.getComponent(o),{windowSizeX:s,windowSizeY:r}=t,i=this._window.width/window.devicePixelRatio,n=this._window.height/window.devicePixelRatio;i===s&&n===r||(t.windowSizeX=i,t.windowSizeY=n)}_setCamera(e){this._updateCameraWindowSize(e),this._store.set(i,e)}process(e){const t=e.messageBus.get(n);if(t){const{gameObjectId:e}=t[t.length-1],s=this._gameObjectObserver.getById(e);if(!s)throw new Error(`Could not set camera with id ${e} for the scene`);this._setCamera(s)}this._updateCameraWindowSize(this._store.get(i))}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(53);t.default=class extends r.default{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(54);const n="COLLISION";t.default=class extends r.default{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._collisionMap={},this._activeCollisions=[]}_publishMessage(e,t){const{gameObject1:s,gameObject2:r,mtv1:i,mtv2:o}=e,a={type:`${n}_${e.getState()}`,id:s.getId(),gameObject1:s,gameObject2:r,mtv1:i,mtv2:o};t.send(a),t.send(a,!0)}_processRemovedGameObjects(e){this._gameObjectObserver.getLastRemoved().forEach(t=>{const s=t.getId();this._activeCollisions=this._activeCollisions.filter(t=>t.gameObject1.getId()!==s&&t.gameObject2.getId()!==s||(t.gameObject2.getId()===s&&(this._collisionMap[t.gameObject1.getId()][s]=null),this._publishMessage(t,e),t.tick(),!1)),this._collisionMap[s]=null})}process(e){const{messageBus:t}=e;this._processRemovedGameObjects(t),(t.get(n)||[]).forEach(e=>{const{gameObject1:t,gameObject2:s,mtv1:r,mtv2:n}=e,o=t.getId(),a=s.getId();if(this._collisionMap[o]=this._collisionMap[o]||{},this._collisionMap[o][a])this._collisionMap[o][a].mtv1=r,this._collisionMap[o][a].mtv2=n,this._collisionMap[o][a].signal();else{const e=new i.default(t,s,r,n);this._collisionMap[o][a]=e,this._activeCollisions.push(e)}}),this._activeCollisions=this._activeCollisions.filter(e=>{const{gameObject1:s,gameObject2:r}=e;return this._publishMessage(e,t),e.tick(),e.isFinished()&&(this._collisionMap[s.getId()][r.getId()]=null),!e.isFinished()})}}},function(e,t,s){"use strict";s.r(t);const r={2:"ENTER",1:"STAY",0:"LEAVE"};t.default=class{constructor(e,t,s,r){this._gameObject1=e,this._gameObject2=t,this._lifetime=2,this._mtv1=s,this._mtv2=r}set gameObject1(e){this._gameObject1=e}get gameObject1(){return this._gameObject1}set gameObject2(e){this._gameObject2=e}get gameObject2(){return this._gameObject2}set mtv1(e){this._mtv1=e}get mtv1(){return this._mtv1}set mtv2(e){this._mtv2=e}get mtv2(){return this._mtv2}isFinished(){return this._lifetime<0}signal(){this._lifetime=1}tick(){this._lifetime-=this._lifetime||1}getState(){return r[this._lifetime]}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(56);t.default=class extends r.default{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(57),n=s(61),o=s(66),a=s(71);const c="colliderContainer",h="transform",u={X:"x",Y:"y"},l="COLLISION";t.default=class extends r.default{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._coordintatesCalculators=Object.keys(i.default).reduce((e,t)=>{const s=i.default[t];return e[t]=new s,e},{}),this._aabbBuilders=Object.keys(n.default).reduce((e,t)=>{const s=n.default[t];return e[t]=new s,e},{}),this._intersectionCheckers=Object.keys(o.default).reduce((e,t)=>{const s=o.default[t];return e[t]=new s,e},{}),this._axis={[u.X]:{sortedList:[],dispersionCalculator:new a.default},[u.Y]:{sortedList:[],dispersionCalculator:new a.default}},this._lastProcessedGameObjects={}}_checkOnReorientation(e){const t=e.getId();if(!this._lastProcessedGameObjects[t])return!0;const s=this._lastProcessedGameObjects[t],r=e.getComponent(h);return r.offsetX!==s.offsetX||r.offsetY!==s.offsetY}_addToAxisSortedList(e,t){[e.aabb.min[t],e.aabb.max[t]].forEach(s=>{this._axis[t].sortedList.push({[t]:s,entry:e})})}_updateAxisSortedList(e,t){const{gameObject:s,aabb:r,coordinates:i}=e,n=s.getId(),o=[r.min[t],r.max[t]],a=this._axis[t].sortedList;for(let e=0;e<a.length&&(n!==a[e].entry.gameObject.getId()||(a[e][t]=o.shift(),a[e].entry.aabb=r,a[e].entry.coordinates=i,o.length));e++);}_removeFromSortedList(e,t){const s=e.getId();this._axis[t].sortedList=this._axis[t].sortedList.filter(e=>s!==e.entry.gameObject.getId())}_getSortingAxis(){return this._axis[u.X].dispersionCalculator.getDispersion()>=this._axis[u.Y].dispersionCalculator.getDispersion()?u.X:u.Y}_sweepAndPrune(e){const t=this._axis[e].sortedList,s=Object.values(u).filter(t=>e!==t);t.sort((t,s)=>t[e]>s[e]?1:t[e]<s[e]?-1:0);let r=t.reduce((e,t)=>{const s=t.entry;return e.activeEntries.has(s)?e.activeEntries.delete(s):(e.activeEntries.forEach(t=>{e.collisions.push([s,t])}),e.activeEntries.add(s)),e},{collisions:[],activeEntries:new Set}).collisions;return s.forEach(e=>{r=r.filter(t=>{const s=t[0].aabb,r=t[1].aabb;return s.max[e]>r.min[e]&&s.min[e]<r.max[e]})}),r}_checkOnIntersection(e){const t=e=>{const t=e.gameObject.getComponent(c);return{colliderType:t.type,collider:t.collider,coordinates:e.coordinates}},s=t(e[0]),r=t(e[1]),i=`${s.colliderType}_${r.colliderType}`;return this._intersectionCheckers[i].check(s,r)}_sendCollisionMessage(e,t,s,r){const{mtv1:i,mtv2:n}=r;[{gameObject1:t,gameObject2:s,mtv1:i,mtv2:n},{gameObject1:s,gameObject2:t,mtv1:n,mtv2:i}].forEach(t=>{e.send({type:l,gameObject1:t.gameObject1,gameObject2:t.gameObject2,mtv1:t.mtv1,mtv2:t.mtv2})})}process(e){const t=e.messageBus;this._gameObjectObserver.getLastRemoved().forEach(e=>{const t=e.getId();Object.values(u).forEach(s=>{this._axis[s].dispersionCalculator.removeFromSample(t),this._removeFromSortedList(e,s)}),this._lastProcessedGameObjects[t]=null}),this._gameObjectObserver.forEach(e=>{if(!this._checkOnReorientation(e))return;const t=e.getId(),s=e.getComponent(h),r=e.getComponent(c),i=this._coordintatesCalculators[r.type].calc(r.collider,s),n=this._aabbBuilders[r.type].getAABB(r.collider,i);Object.values(u).forEach(s=>{const r=.5*(n.min[s]+n.max[s]);this._axis[s].dispersionCalculator.addToSample(t,r);const o={gameObject:e,aabb:n,coordinates:i};this._lastProcessedGameObjects[t]?this._updateAxisSortedList(o,s):this._addToAxisSortedList(o,s)}),this._lastProcessedGameObjects[t]=s.clone()}),this._sweepAndPrune(this._getSortingAxis()).forEach(e=>{const s=this._checkOnIntersection(e);s&&this._sendCollisionMessage(t,e[0].gameObject,e[1].gameObject,s)})}}},function(e,t,s){"use strict";s.r(t);var r=s(58),i=s(60);t.default={boxCollider:r.default,circleCollider:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(46),i=s(59);t.default=class extends i.default{calc(e,t){const{offsetX:s,offsetY:i}=t;let{centerX:n,centerY:o}=e;const{sizeX:a,sizeY:c}=e,h=-a/2+(n+=s),u=a/2+n,l=-c/2+(o+=i),d=c/2+o,_=[{x:h,y:l},{x:h,y:d},{x:u,y:d},{x:u,y:l}];return{center:{x:n,y:o},points:_,edges:_.map((e,t,s)=>{const i=s[(t+1)%s.length];return{point1:e,point2:i,normal:r.VectorOps.getNormal(e.x,i.x,e.y,i.y)}})}}}},function(e,t,s){"use strict";s.r(t);t.default=class{calc(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(59);t.default=class extends r.default{calc(e,t){const{offsetX:s,offsetY:r}=t,{centerX:i,centerY:n}=e;return{center:{x:i+s,y:n+r},points:[],edges:[]}}}},function(e,t,s){"use strict";s.r(t);var r=s(62),i=s(65);t.default={boxCollider:r.default,circleCollider:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(63),i=s(64);t.default=class extends r.default{getAABB(e,t){const s=t.points.reduce((e,t)=>{const s=e.min.x,r=e.min.y,i=e.max.x,n=e.max.y;return e.min.x=null===s||t.x<s?t.x:s,e.min.y=null===r||t.y<r?t.y:r,e.max.x=null===i||t.x>i?t.x:i,e.max.y=null===n||t.y>n?t.y:n,e},{min:{x:null,y:null},max:{x:null,y:null}});return new i.default({x:s.min.x,y:s.min.y},{x:s.max.x,y:s.max.y})}}},function(e,t,s){"use strict";s.r(t);t.default=class{getAABB(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e,t){this._min=e,this._max=t}set min(e){this._min=e}get min(){return this._min}set max(e){this._max=e}get max(){return this._max}}},function(e,t,s){"use strict";s.r(t);var r=s(63),i=s(64);t.default=class extends r.default{getAABB(e,t){const{radius:s}=e,{x:r,y:n}=t.center,o=r-s,a=r+s,c=n-s,h=n+s;return new i.default({x:o,y:c},{x:a,y:h})}}},function(e,t,s){"use strict";s.r(t);var r=s(67),i=s(69),n=s(70);t.default={boxCollider_boxCollider:r.default,circleCollider_circleCollider:i.default,circleCollider_boxCollider:n.default,boxCollider_circleCollider:n.default}},function(e,t,s){"use strict";s.r(t);var r=s(46),i=s(68);t.default=class extends i.default{_projectPolygon(e,t){const s=r.VectorOps.dotProduct(e.edges[0].point1,t),i={min:s,max:s};for(let s=1;s<e.edges.length;s++){const n=r.VectorOps.dotProduct(e.edges[s].point1,t);n<i.min?i.min=n:n>i.max&&(i.max=n)}return i}check(e,t){let s,i;const{x:n,y:o}=e.coordinates.center,{x:a,y:c}=t.coordinates.center;for(let r=0;r<e.coordinates.edges.length/2;r++){const n=e.coordinates.edges[r].normal,o=this._projectPolygon(e.coordinates,n),a=this._projectPolygon(t.coordinates,n),c=o.min-a.max,h=a.min-o.max;if(c>0||h>0)return!1;const u=Math.abs(c),l=Math.abs(h);(void 0===s||u<s)&&(s=u,i=n),(void 0===s||l<s)&&(s=l,i=n)}const h=i.clone();h.multiplyNumber(s);const u=Math.abs(h.x),l=-Math.abs(h.x),d=Math.abs(h.y),_=-Math.abs(h.y);return{mtv1:new r.Vector2(n<a?l:u,o<c?_:d),mtv2:new r.Vector2(a>n?u:l,c>o?d:_)}}}},function(e,t,s){"use strict";s.r(t);t.default=class{check(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(46),i=s(68);t.default=class extends i.default{check(e,t){const{radius:s}=e.collider,{radius:i}=t.collider,{x:n,y:o}=e.coordinates.center,{x:a,y:c}=t.coordinates.center,h=n-a,u=o-c,l=Math.sqrt(Math.pow(h,2)+Math.pow(u,2));if(l>=s+i)return!1;if(0===l)return{mtv1:new r.Vector2(s+i,0),mtv2:new r.Vector2(-(s+i),0)};const d=new r.Vector2(h,u),_=s+i-l;d.multiplyNumber(1/l*_);const g=Math.abs(d.x),f=-Math.abs(d.x),p=Math.abs(d.y),m=-Math.abs(d.y);return{mtv1:new r.Vector2(n<a?f:g,o<c?m:p),mtv2:new r.Vector2(a<n?f:g,c<o?m:p)}}}},function(e,t,s){"use strict";s.r(t);var r=s(46),i=s(68);t.default=class extends i.default{check(e,t){let s,i;e.coordinates.points.length?(s=e,i=t):(s=t,i=e);const{x:n,y:o}=e.coordinates.center,{x:a,y:c}=t.coordinates.center,{radius:h}=i.collider,{x:u,y:l}=i.coordinates.center,{sizeX:d,sizeY:_}=s.collider,{x:g,y:f}=s.coordinates.center,p=g-d/2,m=g+d/2,b=f-_/2,v=f+_/2,O=(e,t)=>{e.multiplyNumber(1/e.magnitude*t);const s=Math.abs(e.x),i=-Math.abs(e.x),h=Math.abs(e.y),u=-Math.abs(e.y);return{mtv1:new r.Vector2(n<a?i:s,o<c?u:h),mtv2:new r.Vector2(a>n?s:i,c>o?h:u)}};let y,E;if(u>p&&u<m&&l>b&&l<v){const e=Math.abs(u-p),t=Math.abs(u-m),s=Math.min(e,t),i=Math.abs(l-b),n=Math.abs(l-v),o=Math.min(i,n);y=e<t?p:m,E=i<n?b:v,s<o?E=l:y=u;const a=r.MathOps.getDistanceBetweenTwoPoints(u,y,l,E);return O(new r.Vector2(y-u,E-l),h+a)}{y=r.MathOps.clamp(u,p,m),E=r.MathOps.clamp(l,b,v);const e=r.MathOps.getDistanceBetweenTwoPoints(u,y,l,E);return!(e>=h)&&O(0!==e?new r.Vector2(y-u,E-l):new r.Vector2(u===p||u===m?g-u:0,l===b||l===v?f-l:0),h-e)}}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(){this._sample={},this._sampleSize=0,this._sum=0,this._squaredSum=0}addToSample(e,t){this.removeFromSample(e),this._sum+=t,this._squaredSum+=Math.pow(t,2),this._sample[e]=t,this._sampleSize+=1}removeFromSample(e){this._sample[e]&&(this._sum-=this._sample[e],this._squaredSum-=Math.pow(this._sample[e],2),this._sample[e]=null,this._sampleSize-=1)}getDispersion(){return this._squaredSum/this._sampleSize-Math.pow(this._sum/this._sampleSize,2)}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(73);t.default=class extends r.default{async load(e){const{gameObjectObserver:t,store:s}=e;return new i.default({gameObjectObserver:t,store:s})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(46);const n="ADD_FORCE",o="STOP_MOVEMENT",a="COLLISION_ENTER",c="COLLISION_STAY",h="rigidBody",u="gravitationalAcceleration",l=0,d=-1;t.default=class extends r.default{constructor(e){super();const{gameObjectObserver:t,store:s}=e;this._store=s,this._gameObjectObserver=t}processorDidMount(){this._gravitationalAcceleration=this._store.get(u)}_addReactionForce(e,t,s){const r=e.getComponent(h),{useGravity:a,mass:c}=r;if(a&&t.y&&-1===Math.sign(t.y)&&!t.x){const t=new i.Vector2(l,d);t.multiplyNumber(c*this._gravitationalAcceleration),s.send({type:n,value:t,gameObject:e,id:e.getId()},!0),s.send({type:o,gameObject:e,id:e.getId()},!0)}}_validateCollision(e,t){const s=e.getComponent(h),r=t.getComponent(h);return s&&!s.ghost&&r&&!r.ghost}process(e){const t=e.messageBus;[t.get(a)||[],t.get(c)||[]].forEach(e=>{e.forEach(e=>{const{gameObject1:s,gameObject2:r,mtv1:i}=e;this._validateCollision(s,r)&&this._addReactionForce(s,i,t)})})}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(75);t.default=class extends r.default{async load(e){const{gameObjectObserver:t}=e;return new i.default({gameObjectObserver:t})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(46);const n="COLLISION_ENTER",o="COLLISION_STAY",a="rigidBody",c={STATIC:"static",DYNAMIC:"dynamic"},h="transform";t.default=class extends r.default{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._processedPairs={},this._mtvMap={}}_validateCollision(e,t){const s=e.getComponent(a),r=t.getComponent(a);return s&&!s.ghost&&!s.isPermeable&&r&&!r.ghost&&!r.isPermeable&&(s.type!==c.STATIC||r.type!==c.STATIC)}_setMtv(e,t,s,r){this._mtvMap[e]=this._mtvMap[e]||{},this._mtvMap[e][r]?{static:()=>{this._mtvMap[e][r].x=Math.abs(t)>Math.abs(this._mtvMap[e][r].x)?t:this._mtvMap[e][r].x,this._mtvMap[e][r].y=Math.abs(s)>Math.abs(this._mtvMap[e][r].y)?s:this._mtvMap[e][r].y},dynamic:()=>{this._mtvMap[e][r].x+=t,this._mtvMap[e][r].y+=s}}[r]():this._mtvMap[e][r]=new i.Vector2(t,s)}_resolveCollision(e,t,s,r){const i=e.getId(),n=t.getId(),o=e.getComponent(a),h=t.getComponent(a);o.type===c.STATIC?this._setMtv(n,r.x,r.y,o.type):h.type===c.STATIC?this._setMtv(i,s.x,s.y,h.type):(this._setMtv(i,s.x/2,s.y/2,h.type),this._setMtv(n,r.x/2,r.y/2,o.type))}process(e){const t=e.messageBus;this._processedPairs={},this._mtvMap={},[t.get(n)||[],t.get(o)||[]].forEach(e=>{e.forEach(e=>{const{gameObject1:t,gameObject2:s,mtv1:r,mtv2:i}=e,n=t.getId(),o=s.getId();this._processedPairs[o]&&this._processedPairs[o][n]||(this._processedPairs[n]=this._processedPairs[n]||{},this._processedPairs[n][o]=!0,this._validateCollision(t,s)&&this._resolveCollision(t,s,r,i))})}),Object.keys(this._mtvMap).forEach(e=>{const t=this._gameObjectObserver.getById(e).getComponent(h),s=Object.keys(this._mtvMap[e]);if(1===s.length)return t.offsetX+=this._mtvMap[e][s[0]].x,void(t.offsetY+=this._mtvMap[e][s[0]].y);const{static:r,dynamic:i}=this._mtvMap[e];t.offsetX+=r.x+i.x,t.offsetY+=r.y+i.y})}}},function(e,t,s){"use strict";s.r(t),s.d(t,"GameStatsMeterPlugin",function(){return n});var r=s(31),i=s(77);class n extends r.default{async load(e){const{frequency:t,gameObjectObserver:s}=e;return new i.GameStatsMeter({frequency:t,gameObjectObserver:s})}}},function(e,t,s){"use strict";s.r(t),s.d(t,"GameStatsMeter",function(){return o});var r=s(30);const i="GAME_STATS_UPDATE",n=1e3;class o extends r.default{constructor(e){super(),this._frequency=e.frequency||n,this._gameObjectObserver=e.gameObjectObserver,this._fps=0,this._time=0}process(e){const{messageBus:t,deltaTime:s}=e;this._fps+=1,this._time+=s,this._time>=this._frequency&&(t.send({type:i,fps:this._fps*n/this._time,gameObjectsCount:this._gameObjectObserver.size(),messagesCount:t.getMessageCount()}),this._fps=0,this._time=0)}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(79);t.default=class extends r.default{async load(e){const{messages:t}=e;return new i.default({messages:t})}}},function(e,t,s){"use strict";s.r(t);var r=s(30);t.default=class extends r.default{constructor(e){super(),this._messages=e.messages}process(e){const t=e.messageBus;this._messages.forEach(e=>{t.delete(e)})}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(81);t.default=class extends r.default{async load(){return new i.default}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(82),n=s(83);const o="INPUT_EVENT_QUERY",a="PRESSED",c="RELEASED",h="_";t.default=class extends r.default{constructor(){super(),this._inputListener=new i.default(window),this._keyCodeMapper=new n.default,this._events=[{type:a,getKeys:()=>this._inputListener.getPressedKeys(),onProcessComplete:()=>this._inputListener.clearPressedKeys()},{type:c,getKeys:()=>this._inputListener.getReleasedKeys(),onProcessComplete:()=>this._inputListener.clearReleasedKeys()}]}processorDidMount(){this._inputListener.startListen()}processorWillUnmount(){this._inputListener.stopListen()}process(e){const t=e.messageBus,s=[];this._events.forEach(e=>{e.getKeys().forEach(t=>{s.push(`${this._keyCodeMapper.getChar(t)}${h}${e.type}`)}),e.onProcessComplete()}),t.send({type:o,query:s})}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e){this._window=e,this._pressedKeys=new Set,this._releasedKeys=new Set}startListen(){this._window.onkeydown=(e=>{this._pressedKeys.add(e.keyCode)}),this._window.onkeyup=(e=>{this._pressedKeys.delete(e.keyCode),this._releasedKeys.add(e.keyCode)})}stopListen(){this._window.onkeydown=null}getPressedKeys(){return Array.from(this._pressedKeys)}getReleasedKeys(){return Array.from(this._releasedKeys)}clearPressedKeys(){this._pressedKeys.clear()}clearReleasedKeys(){this._releasedKeys.clear()}}},function(e,t,s){"use strict";s.r(t);var r=s(84);t.default=class{getChar(e){return r.default[e]}}},function(e,t,s){"use strict";s.r(t),t.default={8:"BACKSPACE",9:"TAB",16:"SHIFT",17:"CONTROL",18:"ALT",27:"ESCAPE",32:"SPACE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",187:"=",189:"-",220:"\\"}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(86);t.default=class extends r.default{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(30);const i="keyboardControl",n="INPUT_EVENT_QUERY",o="RELEASED",a="_";t.default=class extends r.default{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver}process(e){const t=e.messageBus;this._gameObjectObserver.forEach(e=>{const s=e.getComponent(i);(t.get(n)||[]).forEach(e=>{e.query.forEach(e=>{const t=e.split(a),r=t[0],i=t[1];r in s.keyStates&&(s.keyStates[r]=i)})}),Object.keys(s.keyStates).forEach(r=>{const i=s.keyStates[r],n=s.inputEventBindings[`${r}${a}${i}`];if(i&&n){if(!n.messageType)throw new Error(`The message type not specified for input event: ${i}`);t.send({type:n.messageType,...n.attrs,gameObject:e,id:e.getId()})}i===o&&(s.keyStates[r]=null)})})}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(88);t.default=class extends r.default{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(30);const i="mouseControl",n="MOUSE_INPUT_EVENT_QUERY";t.default=class extends r.default{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver}process(e){const t=e.messageBus;(t.get(n)||[]).forEach(e=>{e.query.forEach(e=>{this._gameObjectObserver.forEach(s=>{const r=s.getComponent(i).inputEventBindings[e.type];if(r){if(!r.messageType)throw new Error(`The message type not specified for input event: ${e.type}`);t.send({type:r.messageType,...r.attrs,gameObject:s,id:s.getId(),x:e.x,y:e.y,screenX:e.screenX,screenY:e.screenY})}})})})}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(90);t.default=class extends r.default{async load(){return new i.default}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(91);const n="MOUSE_INPUT_EVENT_QUERY",o={1:"LEFT",2:"MIDDLE",3:"RIGHT"},a={mousedown:e=>`MOUSE_${o[e.which]}_BUTTON_PRESS`,mouseup:e=>`MOUSE_${o[e.which]}_BUTTON_RELEASE`,mousemove:()=>"MOUSE_MOVE",click:()=>"MOUSE_LEFT_BUTTON_CLICK",contextmenu:()=>"MOUSE_RIGHT_BUTTON_CLICK",dblclick:()=>"MOUSE_DOUBLE_CLICK"};t.default=class extends r.default{constructor(){super(),this._inputListener=new i.default(window)}processorDidMount(){this._inputListener.startListen()}processorWillUnmount(){this._inputListener.stopListen()}process(e){const t=e.messageBus,s=(this._inputListener.getFiredEvents()||[]).map(e=>({type:a[e.type](e),x:e.clientX,y:e.clientY}));this._inputListener.clearFiredEvents(),t.send({type:n,query:s})}}},function(e,t,s){"use strict";s.r(t);const r=["onmousedown","onmouseup","onmousemove","onclick","oncontextmenu","ondblclick"];t.default=class{constructor(e){this._window=e,this._firedEvents=[]}startListen(){r.forEach(e=>{this._window[e]=(e=>{this._firedEvents.push(e)})})}stopListen(){r.forEach(e=>{this._window[e]=null})}getFiredEvents(){return this._firedEvents}clearFiredEvents(){this._firedEvents=[]}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(93);t.default=class extends r.default{async load(e){const{store:t}=e;return new i.default({store:t})}}},function(e,t,s){"use strict";s.r(t);var r=s(30);const i="MOUSE_INPUT_EVENT_QUERY",n="currentCamera",o="camera",a="transform";t.default=class extends r.default{constructor(e){super();const{store:t}=e;this._store=t}process(e){const t=e.messageBus,s=this._store.get(n),{windowSizeX:r,windowSizeY:c,zoom:h}=s.getComponent(o),u=r/2,l=c/2,{offsetX:d,offsetY:_}=s.getComponent(a);(t.get(i)||[]).forEach(e=>{e.query.forEach(e=>{e.screenX=e.x,e.screenY=e.y,e.x=(e.x-u)/h+d,e.y=(e.y-l)/h+_})})}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(95);t.default=class extends r.default{async load(e){const{gravitationalAcceleration:t,gameObjectObserver:s,store:r}=e;return new i.default({gravitationalAcceleration:t,gameObjectObserver:s,store:r})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(46);const n="ADD_FORCE",o="ADD_IMPULSE",a="STOP_MOVEMENT",c="rigidBody",h="transform",u="gravitationalAcceleration",l={UP:new i.Vector2(0,-1),LEFT:new i.Vector2(-1,0),RIGHT:new i.Vector2(1,0),DOWN:new i.Vector2(0,1)};t.default=class extends r.default{constructor(e){super();const{gravitationalAcceleration:t,gameObjectObserver:s,store:r}=e;this._gravitationalAcceleration=t,this._gameObjectObserver=s,this._store=r,this._gameObjectsVelocity={}}processorDidMount(){this._store.set(u,this._gravitationalAcceleration)}_applyDragForce(e,t){const{mass:s,drag:r}=e.getComponent(c),i=e.getId(),n=this._gameObjectsVelocity[i];if(!r||!n||!n.x&&!n.y)return;const o=Math.sign(n.x),a=Math.sign(n.y),h=-1*r*(s*this._gravitationalAcceleration)*(t/s),u=1/n.magnitude,l=n.clone();l.multiplyNumber(h*u),n.add(l),Math.sign(n.x)!==o&&Math.sign(n.y)!==a&&n.multiplyNumber(0)}_getGravityForce(e){const{mass:t,useGravity:s}=e,r=new i.Vector2(0,0);return s&&(r.add(l.DOWN),r.multiplyNumber(t*this._gravitationalAcceleration)),r}_getForceVector(e,t){const s=e.getId(),r=e.getComponent(c),o=new i.Vector2(0,0);return o.add(this._getGravityForce(r)),(t.getById(n,s)||[]).forEach(e=>o.add(e.value)),o}_getImpulseVector(e,t){const s=e.getId();return(t.getById(o,s)||[]).reduce((e,t)=>(e.add(t.value),e),new i.Vector2(0,0))}_processConstraints(e){(e.get(a)||[]).forEach(e=>{const{gameObject:t}=e,s=t.getId();this._gameObjectsVelocity[s]&&this._gameObjectsVelocity[s].multiplyNumber(0)})}_processRemovedGameObjects(){this._gameObjectObserver.getLastRemoved().forEach(e=>{const t=e.getId();this._gameObjectsVelocity[t]=null})}process(e){const t=e.deltaTime/1e3,s=e.messageBus;this._processRemovedGameObjects(),this._processConstraints(s),this._gameObjectObserver.forEach(e=>{const r=e.getId(),n=e.getComponent(c),o=e.getComponent(h),{mass:a}=n,u=this._getForceVector(e,s),l=this._getImpulseVector(e,s);this._gameObjectsVelocity[r]=this._gameObjectsVelocity[r]||new i.Vector2(0,0);const d=this._gameObjectsVelocity[r];(u.x||u.y)&&(u.multiplyNumber(t/a),d.add(u)),(l.x||l.y)&&(l.multiplyNumber(1/a),d.add(l)),this._applyDragForce(e,t),o.offsetX=o.offsetX+d.x*t,o.offsetY=o.offsetY+d.y*t})}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(5),n=s(10),o=s(97);t.default=class extends r.default{async load(e){const t=i.default.resolve(n.RESOURCES_LOADER_KEY_NAME),{windowNodeId:s,textureAtlas:r,textureAtlasDescriptor:a,backgroundColor:c,sortingLayers:h,scaleSensitivity:u,gameObjectObserver:l,store:d}=e,_=document.getElementById(s),g=[r,a],f=await Promise.all(g.map(e=>t.load(e)));return new o.default({window:_,textureAtlas:f[0],textureAtlasDescriptor:f[1],backgroundColor:c,sortingLayers:h,scaleSensitivity:u,gameObjectObserver:l,store:d})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(98),n=s(99),o=s(104),a=s(108),c=s(111);const h=255,u=0,l=6,d=1080,_=2,g=Float32Array.BYTES_PER_ELEMENT*_,f=3,p=3*f,m=Float32Array.BYTES_PER_ELEMENT*p,b=Float32Array.BYTES_PER_ELEMENT*f,v=5*_+p,O=v*l,y=1e3*O*Float32Array.BYTES_PER_ELEMENT,E="renderable",w="transform",x="camera",C="currentCamera";t.default=class extends r.default{constructor(e){super();const{window:t,textureAtlas:s,textureAtlasDescriptor:r,backgroundColor:i,gameObjectObserver:a,sortingLayers:h,store:u,scaleSensitivity:l}=e;this.textureAtlas=s,this.textureAtlasSize={width:this.textureAtlas.width,height:this.textureAtlas.height},this.textureAtlasDescriptor=r,this.textureHandlers=Object.keys(o.default).reduce((e,t)=>{const s=o.default[t];return e[t]=new s,e},{}),this._matrixTransformer=new c.default,this._backgroundColor=new n.default(i),this._view=t,this._viewWidth,this._viewHeight,this._windowDidResize=!0,this._onWindowResize=this._onWindowResize.bind(this),this._shaders=[],this._sortingLayer=h.reduce((e,t,s)=>(e[t]=s,e),{}),this._store=u,this._gameObjectObserver=a,this._scaleSensitivity=Math.min(Math.max(l,0),100)/100,this._screenScale=1,this._vaoExt=null,this._buffer=null,this._vao=null,this._geometry={},this._viewMatrixStats={},this._vertexData=null,this._gameObjectsCount=0}processorDidMount(){window.addEventListener("resize",this._onWindowResize),this.gl=this._initGraphicContext(),this._initExtensions(),this._initScreen(),this.program=this._initShaders(),this._initProgramInfo(),this.textures=this._initTextures()}processorWillUnmount(){window.removeEventListener("resize",this._onWindowResize),this._shaders.forEach(e=>{this.gl.detachShader(this.program,e),this.gl.deleteShader(e)}),this.gl.deleteProgram(this.program),this.gl.deleteTexture(this.textures),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this._buffer=null,this._shaders=[],this.program=null,this.textures=null,this.gl=null,this._vao=null,this._vaoExt=null,this._geometry={},this._viewMatrixStats={},this._vertexData=null,this._gameObjectsCount=0}_onWindowResize(){this._windowDidResize=!0}_initGraphicContext(){let e=null;try{e=this._view.getContext("webgl")||this._view.getContext("experimental-webgl")}catch(e){throw new Error("Unable to get graphic context.")}if(!e)throw new Error("Unable to initialize WebGL. Your browser may not support it.");return e}_initExtensions(){if(this._vaoExt=this.gl.getExtension("OES_vertex_array_object"),!this._vaoExt)return alert("Unable to initialize OES_vertex_array_object extension")}_initScreen(){this.gl.clearColor(this._backgroundColor.red()/h,this._backgroundColor.green()/h,this._backgroundColor.blue()/h,1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.depthFunc(this.gl.LEQUAL),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}_initShaders(){const e=new a.default(this.gl),t=e.create(e.VERTEX_SHADER),s=e.create(e.FRAGMENT_SHADER),r=this.gl.createProgram();if(this.gl.attachShader(r,t),this.gl.attachShader(r,s),this.gl.linkProgram(r),!this.gl.getProgramParameter(r,this.gl.LINK_STATUS))throw new Error("Unable to initialize the shader program.");return this._shaders.push(t,s),r}_initProgramInfo(){this.gl.useProgram(this.program),this._variables={aPosition:this.gl.getAttribLocation(this.program,"a_position"),aTexCoord:this.gl.getAttribLocation(this.program,"a_texCoord"),aModelViewMatrix:this.gl.getAttribLocation(this.program,"a_modelViewMatrix"),aTexSize:this.gl.getAttribLocation(this.program,"a_texSize"),aTexTranslate:this.gl.getAttribLocation(this.program,"a_texTranslate"),aGameObjectSize:this.gl.getAttribLocation(this.program,"a_gameObjectSize"),uViewMatrix:this.gl.getUniformLocation(this.program,"u_viewMatrix"),uTexAtlasSize:this.gl.getUniformLocation(this.program,"u_texAtlasSize")},this._buffer=this.gl.createBuffer(),this._vao=this._createVAO(),this._setUpGlobalUniforms()}_createVAO(){const e=this._vaoExt.createVertexArrayOES();this._vaoExt.bindVertexArrayOES(e),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this._buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,y,this.gl.DYNAMIC_DRAW);const t=[{loc:this._variables.aPosition,type:"vec2"},{loc:this._variables.aTexCoord,type:"vec2"},{loc:this._variables.aModelViewMatrix,type:"mat3"},{loc:this._variables.aTexSize,type:"vec2"},{loc:this._variables.aTexTranslate,type:"vec2"},{loc:this._variables.aGameObjectSize,type:"vec2"}],s={mat3:m,vec2:g},r=t.reduce((e,t)=>e+s[t.type],0);let i=0;for(let e=0;e<t.length;e++)if("vec2"===t[e].type)this.gl.enableVertexAttribArray(t[e].loc),this.gl.vertexAttribPointer(t[e].loc,_,this.gl.FLOAT,!1,r,i),i+=g;else if("mat3"===t[e].type){for(let s=0;s<f;s++){const n=t[e].loc+s;this.gl.enableVertexAttribArray(n),this.gl.vertexAttribPointer(n,f,this.gl.FLOAT,!1,r,i+s*b)}i+=m}return this._vaoExt.bindVertexArrayOES(null),e}_setUpGlobalUniforms(){this.gl.uniform2fv(this._variables.uTexAtlasSize,[this.textureAtlasSize.width,this.textureAtlasSize.height])}_initTextures(){const e=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.textureAtlas),e}_getModelViewMatrix(e,t,s,r,i,n){const o=this._matrixTransformer,a=o.getIdentityMatrix();return o.translate(a,e.origin[0],e.origin[1]),o.scale(a,i,n),e.flipX&&o.flipX(a),e.flipY&&o.flipY(a),o.rotate(a,(e.rotation+r)%360),o.translate(a,t,s),a}_getCompareFunction(){return(e,t)=>{const s=e.getComponent(E),r=t.getComponent(E),i=this._sortingLayer[s.sortingLayer],n=this._sortingLayer[r.sortingLayer];if(i>n)return 1;if(i<n)return-1;const o=e.getComponent(w),a=t.getComponent(w),c=o.offsetY+o.scaleY*s.height/2,h=a.offsetY+a.scaleY*r.height/2;if(c>h)return 1;if(c<h)return-1;const u=o.offsetX+o.scaleX*s.width/2,l=a.offsetX+a.scaleX*r.width/2;return u>l?1:u<l?-1:o.offsetZ-a.offsetZ}}_setUpTextureInfo(e,t,s){this._vertexData[s]=e.width,this._vertexData[s+1]=e.height,this._vertexData[s+2]=e.x,this._vertexData[s+3]=e.y,this._vertexData[s+4]=t.width,this._vertexData[s+5]=t.height}_setUpMatrix(e,t){this._vertexData[t]=e[0],this._vertexData[t+1]=e[1],this._vertexData[t+2]=e[2],this._vertexData[t+3]=e[3],this._vertexData[t+4]=e[4],this._vertexData[t+5]=e[5],this._vertexData[t+6]=e[6],this._vertexData[t+7]=e[7],this._vertexData[t+8]=e[8]}_setUpVertexData(e,t){const s=e.getId(),r=e.getComponent(E),n=t*O;if(r.disabled){for(let e=0;e<O;e++)this._vertexData[n+e]=0;return}const o=e.getComponent(w),a=this.textureAtlasDescriptor[r.src],c=this.textureHandlers[r.type].handle(a,r),h=this._getModelViewMatrix(r,o.offsetX,o.offsetY,o.rotation,o.scaleX,o.scaleY);this._geometry[s]||(this._geometry[s]={position:new i.default(r.width,r.height).toArray(),texCoord:new i.default(c.width,c.height).toArray()});const u=this._geometry[s].position,l=this._geometry[s].texCoord;for(let e=0,t=n;e<u.length;e+=2,t+=v)this._vertexData[t]=u[e],this._vertexData[t+1]=u[e+1],this._vertexData[t+2]=l[e],this._vertexData[t+3]=l[e+1],this._setUpMatrix(h,t+2*_),this._setUpTextureInfo(c,r,t+2*_+p)}_resizeCanvas(e){if(!this._windowDidResize)return;const t=window.devicePixelRatio||1;this._viewWidth=this._view.clientWidth,this._viewHeight=this._view.clientHeight;const s=this._viewWidth*t,r=this._viewHeight*t;e.width=s,e.height=r;const i=Math.sqrt(Math.pow(e.clientWidth,2)+Math.pow(e.clientHeight,2)),n=1-this._scaleSensitivity,o=i-(i-d)*n;this._screenScale=o/d,this.gl.viewport(0,0,s,r),this._windowDidResize=!1}_updateViewMatrix(){const e=this._store.get(C),t=e.getComponent(w),{zoom:s}=e.getComponent(x),r=s*this._screenScale,i=this._viewMatrixStats;if(i.x===t.offsetX&&i.y===t.offsetY&&i.width===this._viewWidth&&i.height===this._viewHeight&&i.scale===r)return;const n=this._matrixTransformer,o=n.getIdentityMatrix();n.translate(o,-t.offsetX,-t.offsetY),n.scale(o,r,r),n.project(o,this._viewWidth,this._viewHeight),this.gl.uniformMatrix3fv(this._variables.uViewMatrix,!1,o),this._viewMatrixStats.width=this._viewWidth,this._viewMatrixStats.height=this._viewHeight,this._viewMatrixStats.x=t.offsetX,this._viewMatrixStats.y=t.offsetY,this._viewMatrixStats.scale=r}_allocateVertexData(){const e=this._gameObjectObserver.size();this._gameObjectsCount!==e&&(this._gameObjectsCount=e,this._vertexData=new Float32Array(this._gameObjectsCount*O))}_setUpBuffers(){this._vaoExt.bindVertexArrayOES(this._vao),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this._vertexData)}_processRemovedGameObjects(){this._gameObjectObserver.getLastRemoved().forEach(e=>{const t=e.getId();this._geometry[t]=null})}process(){const e=this.gl.canvas;this._resizeCanvas(e),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this._processRemovedGameObjects(),this._updateViewMatrix(),this._allocateVertexData(),this._gameObjectObserver.sort(this._getCompareFunction()),this._gameObjectObserver.forEach((e,t)=>{this._setUpVertexData(e,t)}),this._setUpBuffers(),this.gl.drawArrays(this.gl.TRIANGLES,u,l*this._gameObjectObserver.size())}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e,t){this._width=e,this._height=t}toArray(){const e=0+this._width,t=0+this._height;return[0,0,e,0,0,t,0,t,e,0,e,t]}}},function(e,t,s){"use strict";s.r(t);var r=s(100);const i=/#[0-9a-zA-Z]{6}/,n=/#[0-9a-zA-Z]{3}/,o="red",a="green",c="blue";t.default=class{constructor(e){const t=[{regexp:i,reader:r.default.hexColorReader},{regexp:n,reader:r.default.shortHeColorReader}];if(this._color=void 0,t.some(t=>{if(e.match(t.regexp)){const s=t.reader;return this._color=(new s).read(e),!0}}),!this._color)throw new Error("Error while color initialization: unknown type of color presentation")}red(){return this._color[o]}green(){return this._color[a]}blue(){return this._color[c]}}},function(e,t,s){"use strict";s.r(t);var r=s(101),i=s(103);t.default={hexColorReader:r.default,shortHeColorReader:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(102);const i=8,n=16,o=255,a="#",c=["red","green","blue"];t.default=class extends r.default{read(e){const t=parseInt(e.replace(a,""),n);return c.reduce((e,s,r,n)=>(e[s]=t>>i*(n.length-r-1)&o,e),{})}}},function(e,t,s){"use strict";s.r(t);t.default=class{read(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(102);const i=16,n=2,o="#",a=["red","green","blue"];t.default=class extends r.default{read(e){return e=e.replace(o,""),a.reduce((t,s,r)=>(t[s]=parseInt(e[r].repeat(n),i),t),{})}}},function(e,t,s){"use strict";s.r(t);var r=s(105),i=s(107);t.default={static:r.default,sprite:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(106);t.default=class extends r.default{handle(e){return{x:e.x,y:e.y,width:e.width,height:e.height}}}},function(e,t,s){"use strict";s.r(t);t.default=class{handle(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(106);t.default=class extends r.default{handle(e,t){const{x:s,y:r,width:i,height:n}=e,{spacing:o,extruding:a,slice:c}=t,h=2*a,u=(i-(c-1)*o)/c-h,l=n-h;return{x:s+(u+o+h)*t.currentFrame+a,y:r+a,width:u,height:l}}}},function(e,t,s){"use strict";s.r(t);var r=s(109),i=s(110);const n="FRAGMENT_SHADER",o="VERTEX_SHADER",a={[n]:r.default,[o]:i.default};t.default=class{constructor(e){this.graphicContext=e,this.FRAGMENT_SHADER=n,this.VERTEX_SHADER=o,this.creators={[n]:this._createFragmentShader.bind(this),[o]:this._createVertexShader.bind(this)}}_createFragmentShader(){return this.graphicContext.createShader(this.graphicContext.FRAGMENT_SHADER)}_createVertexShader(){return this.graphicContext.createShader(this.graphicContext.VERTEX_SHADER)}create(e){const t=this.creators[e]();if(this.graphicContext.shaderSource(t,a[e]),this.graphicContext.compileShader(t),!this.graphicContext.getShaderParameter(t,this.graphicContext.COMPILE_STATUS)){const e=this.graphicContext.getShaderInfoLog(t);throw new Error(`An error occurred compiling the shaders: ${e}`)}return t}}},function(e,t,s){"use strict";s.r(t);t.default="\nprecision highp float;\n\nuniform sampler2D u_image;\nuniform vec2 u_texAtlasSize;\n\nvarying vec2 v_texCoord;\nvarying vec2 v_texSize;\nvarying vec2 v_texTranslate;\nvarying vec2 v_gameObjectSize;\n\nfloat calculateCoord(float gameObjectSize, float texSize, float texTranslate, float texCoord) {\n  if (gameObjectSize > texSize) {\n    float repeat = gameObjectSize / texSize;\n    return mod(texCoord * repeat, texSize) + texTranslate;\n  } else {\n    return texCoord + texTranslate;\n  }\n}\n\nvoid main() {\n  vec2 texCoord = vec2(\n    calculateCoord(v_gameObjectSize.x, v_texSize.x, v_texTranslate.x, v_texCoord.x),\n    calculateCoord(v_gameObjectSize.y, v_texSize.y, v_texTranslate.y, v_texCoord.y)\n  );\n\n  gl_FragColor = texture2D(u_image, texCoord / u_texAtlasSize);\n}\n"},function(e,t,s){"use strict";s.r(t);t.default="\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nattribute mat3 a_modelViewMatrix;\n\nattribute vec2 a_texSize;\nattribute vec2 a_texTranslate;\nattribute vec2 a_gameObjectSize;\n\nuniform mat3 u_viewMatrix;\n\nvarying vec2 v_texCoord;\nvarying vec2 v_texSize;\nvarying vec2 v_texTranslate;\nvarying vec2 v_gameObjectSize;\n\nvoid main() {\n  mat3 matrix = u_viewMatrix * a_modelViewMatrix;\n  gl_Position = vec4((matrix * vec3(a_position, 1)).xy, 0, 1);\n\n  v_texCoord = a_texCoord;\n  v_texSize = a_texSize;\n  v_texTranslate = a_texTranslate;\n  v_gameObjectSize = a_gameObjectSize;\n}\n"},function(e,t,s){"use strict";s.r(t);t.default=class{getIdentityMatrix(){return[1,0,0,0,1,0,0,0,1]}project(e,t,s){const r=2/t,i=2/s;e[0]=e[0]*r,e[1]=-e[1]*i,e[3]=e[3]*r,e[4]=-e[4]*i,e[6]=e[6]*r,e[7]=-e[7]*i}translate(e,t,s){e[0]=e[0]+e[2]*t,e[1]=e[1]+e[2]*s,e[3]=e[3]+e[5]*t,e[4]=e[4]+e[5]*s,e[6]=e[6]+e[8]*t,e[7]=e[7]+e[8]*s}flipX(e){this.scale(e,-1,1)}flipY(e){this.scale(e,1,-1)}scale(e,t,s){e[0]=e[0]*t,e[1]=e[1]*s,e[3]=e[3]*t,e[4]=e[4]*s,e[6]=e[6]*t,e[7]=e[7]*s}rotate(e,t){t=t*Math.PI/180;const s=Math.cos(t),r=-Math.sin(t),i=e[0],n=e[3],o=e[6];e[0]=i*s+e[1]*r,e[1]=e[1]*s-i*r,e[3]=n*s+e[4]*r,e[4]=e[4]*s-n*r,e[6]=o*s+e[7]*r,e[7]=e[7]*s-o*r}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(113);t.default=class extends r.default{async load(e){const{sceneController:t}=e;return new i.default({sceneController:t})}}},function(e,t,s){"use strict";s.r(t);var r=s(30);const i="LOAD_SCENE";t.default=class extends r.default{constructor(e){super(),this._sceneController=e.sceneController,this._sceneLoading=!1}_loadScene(e){const t=e.get(i);if(t){const{name:e}=t[t.length-1];this._sceneController.load(e),this._sceneLoading=!0}}_moveToLoaded(e){e.reset(),this._sceneController.moveToLoaded(),this._sceneLoading=!1}process(e){const t=e.messageBus;this._sceneLoading?this._sceneController.isLoaded()&&this._moveToLoaded(t):this._loadScene(t)}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(115);t.default=class extends r.default{async load(e){const{helpers:t,gameObjectObserver:s,gameObjectSpawner:r,gameObjectDestroyer:n,store:o}=e,{scripts:a}=await t.loadScripts();return new i.default({gameObjectObserver:s,gameObjectSpawner:r,gameObjectDestroyer:n,store:o,scripts:a})}}},function(e,t,s){"use strict";s.r(t);var r=s(30);const i="script";t.default=class extends r.default{constructor(e){super();const{gameObjectObserver:t,gameObjectSpawner:s,gameObjectDestroyer:r,store:i,scripts:n}=e;this._gameObjectObserver=t,this._gameObjectSpawner=s,this._gameObjectDestroyer=r,this._store=i,this._scripts=n,this._activeScripts={}}_processRemovedGameObjects(){this._gameObjectObserver.getLastRemoved().forEach(e=>{const t=e.getId();this._activeScripts[t]=null})}process(e){const{messageBus:t,deltaTime:s}=e;this._processRemovedGameObjects(),this._gameObjectObserver.forEach(e=>{const r=e.getId(),{name:n}=e.getComponent(i),o=this._scripts[n];this._activeScripts[r]=this._activeScripts[r]||new o(e,this._store,this._gameObjectSpawner,this._gameObjectDestroyer),this._activeScripts[r].update(t,s)})}}},function(e,t,s){"use strict";s.r(t);var r=s(31),i=s(117);t.default=class extends r.default{async load(e){const{helpers:t,sceneController:s,gameObjectObserver:r,gameObjectSpawner:n,gameObjectDestroyer:o,store:a}=e,{onInit:c,onDestroy:h}=await t.loadUiApp();return new i.default({onInit:c,onDestroy:h,sceneController:s,gameObjectObserver:r,gameObjectSpawner:n,gameObjectDestroyer:o,store:a})}}},function(e,t,s){"use strict";s.r(t);var r=s(30),i=s(118),n=s(119);t.default=class extends r.default{constructor(e){super();const{onInit:t,onDestroy:s,sceneController:r,gameObjectObserver:o,gameObjectSpawner:a,gameObjectDestroyer:c,store:h}=e;this._onUiInit=t,this._onUiDestroy=s,this._sceneController=r,this._gameObjectObserver=o,this._gameObjectSpawner=a,this._gameObjectDestroyer=c,this._store=h,this._messageBusObserver=new i.default,this._storeObserver=new i.default,this._gameObjects=new n.default,this._messageQueue=[],this._actionsQueue=[]}processorDidMount(){this._onUiInit({sceneName:this._sceneController.getCurrentName(),messageBusObserver:this._messageBusObserver,storeObserver:this._storeObserver,pushMessage:this._pushMessage.bind(this),pushAction:this._pushAction.bind(this),gameObjects:this._gameObjects})}processorWillUnmount(){this._onUiDestroy()}_pushAction(e){this._actionsQueue.push(e)}_pushMessage(e){this._messageQueue.push(e)}_processRemovedGameObjects(){this._gameObjectObserver.getLastRemoved().forEach(e=>{this._gameObjects.next(null,e.getId())})}process(e){const{messageBus:t,deltaTime:s}=e;this._processRemovedGameObjects(),this._gameObjectObserver.forEach(e=>{this._gameObjects.next(e,e.getId())}),this._messageBusObserver.next(t),this._storeObserver.next(this._store),this._messageQueue.forEach(e=>{t.send(e,!0)}),this._messageQueue=[],this._actionsQueue.forEach(e=>{e({messageBus:t,deltaTime:s,store:this._store,gameObjectSpawner:this._gameObjectSpawner,gameObjectDestroyer:this._gameObjectDestroyer})}),this._actionsQueue=[]}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(){this._value=null,this._subscribers=[]}next(e){this._value=e,this._subscribers.forEach(e=>e(this._value))}subscribe(e){if(!(e instanceof Function))throw new Error("Callback should be a function");this._subscribers.push(e)}unsubscribe(e){if(!(e instanceof Function))throw new Error("Callback should be a function");this._subscribers=this._subscribers.filter(t=>t!==e)}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(){this._values={},this._subscribers={}}next(e,t){this._values[t]=e,this._subscribers[t]&&this._subscribers[t].forEach(e=>e(this._values[t]))}subscribe(e,t){if(!(e instanceof Function))throw new Error("Callback should be a function");this._subscribers[t]=this._subscribers[t]||[],this._subscribers[t].push(e)}unsubscribe(e,t){if(!(e instanceof Function))throw new Error("Callback should be a function");this._subscribers[t]&&(this._subscribers[t]=this._subscribers[t].filter(t=>t!==e))}}},function(e,t,s){"use strict";s.r(t);var r=s(121),i=s(122),n=s(123),o=s(126),a=s(127),c=s(145),h=s(146),u=s(147),l=s(148);t.default={camera:r.default,keyboardControl:i.default,colliderContainer:n.default,rigidBody:o.default,animatable:a.default,renderable:c.default,transform:h.default,mouseControl:u.default,script:l.default}},function(e,t,s){"use strict";s.r(t);var r=s(32);class i extends r.default{constructor(e,t){super(e,t),this._zoom=t.zoom,this._windowSizeX=0,this._windowSizeY=0}set zoom(e){this._zoom=e}get zoom(){return this._zoom}set windowSizeX(e){this._windowSizeX=e}get windowSizeX(){return this._windowSizeX}set windowSizeY(e){this._windowSizeY=e}get windowSizeY(){return this._windowSizeY}clone(){return new i(this.componentName,{zoom:this.zoom})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(32);const i="_";class n extends r.default{constructor(e,t){super(e,t),this._inputEventBindings=t.inputEventBindings,this._keyStates=Object.keys(this._inputEventBindings).reduce((e,t)=>(e[t.split(i)[0]]=null,e),{})}set inputEventBindings(e){this._inputEventBindings=e}get inputEventBindings(){return this._inputEventBindings}set keyStates(e){this._keyStates=e}get keyStates(){return this._keyStates}clone(){return new n(this.componentName,{inputEventBindings:{...this.inputEventBindings}})}}t.default=n},function(e,t,s){"use strict";s.r(t);var r=s(32),i=s(124),n=s(125);class o extends r.default{constructor(e,t){if(super(e,t),this._colliders={boxCollider:i.default,circleCollider:n.default},this._type=t.type,!this._colliders[this.type])throw new Error(`Not found collider with same type: ${this.type}`);this._collider=new this._colliders[this.type](t.collider)}set type(e){this._type=e}get type(){return this._type}set collider(e){this._collider=e}get collider(){return this._collider}clone(){return new o(this.componentName,{type:this.type,collider:this.collider.clone()})}}t.default=o},function(e,t,s){"use strict";s.r(t);class r{constructor(e){this._sizeX=e.sizeX,this._sizeY=e.sizeY,this._centerX=e.centerX,this._centerY=e.centerY}set sizeX(e){this._sizeX=e}get sizeX(){return this._sizeX}set sizeY(e){this._sizeY=e}get sizeY(){return this._sizeY}set centerX(e){this._centerX=e}get centerX(){return this._centerX}set centerY(e){this._centerY=e}get centerY(){return this._centerY}clone(){return new r({sizeX:this.sizeX,sizeY:this.sizeY,centerX:this.centerX,centerY:this.centerY})}}t.default=r},function(e,t,s){"use strict";s.r(t);class r{constructor(e){this._radius=e.radius,this._centerX=e.centerX,this._centerY=e.centerY}set radius(e){this._radius=e}get radius(){return this._radius}set centerX(e){this._centerX=e}get centerX(){return this._centerX}set centerY(e){this._centerY=e}get centerY(){return this._centerY}clone(){return new r({radius:this.radius,centerX:this.centerX,centerY:this.centerY})}}t.default=r},function(e,t,s){"use strict";s.r(t);var r=s(32);class i extends r.default{constructor(e,t){super(e,t),this._type=t.type,this._mass=t.mass,this._useGravity=t.useGravity,this._isPermeable=t.isPermeable,this._ghost=t.ghost,this._drag=t.drag}set mass(e){this._mass=e}get mass(){return this._mass}set useGravity(e){this._useGravity=e}get useGravity(){return this._useGravity}set isPermeable(e){this._isPermeable=e}get isPermeable(){return this._isPermeable}set ghost(e){this._ghost=e}get ghost(){return this._ghost}set type(e){this._type=e}get type(){return this._type}set drag(e){this._drag=e}get drag(){return this._drag}clone(){return new i(this.componentName,{mass:this.mass,useGravity:this.useGravity,isPermeable:this.isPermeable,ghost:this.ghost,type:this.type,drag:this.drag})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(32),i=s(128),n=s(140);class o extends r.default{constructor(e,t){super(e,t),this._states=t.states.map(e=>"individual"===e.type?new i.default(e):"group"===e.type?new n.default(e):void 0),this._initialState=t.initialState,this.currentState=this._initialState,this._duration=0}set states(e){this._states=e}get states(){return this._states}set initialState(e){this._initialState=e}get initialState(){return this._initialState}set currentState(e){this._currentState=this.states.find(t=>t.name===e)}get currentState(){return this._currentState}set duration(e){this._duration=e}get duration(){return this._duration}clone(){return new o(this.componentName,{states:this.states,initialState:this.initialState})}}t.default=o},function(e,t,s){"use strict";s.r(t);var r=s(129),i=s(138);t.default=class extends r.default{constructor(e){super(e),this._timeline=new i.default(e.timeline)}set timeline(e){this._timeline=e}get timeline(){return this._timeline}}},function(e,t,s){"use strict";s.r(t);var r=s(130);t.default=class{constructor(e){this._name=e.name,this._speed=e.speed,this._type=e.type,this._transitions=e.transitions.map(e=>new r.default(e))}set name(e){this._name=e}get name(){return this._name}set speed(e){this._speed=e}get speed(){return this._speed}set type(e){this._type=e}get type(){return this._type}set transitions(e){this._transitions=e}get transitions(){return this._transitions}}},function(e,t,s){"use strict";s.r(t);var r=s(131);t.default=class{constructor(e){this._state=e.state,this._time=e.time,this._conditions=e.conditions.map(e=>new r.default(e))}set state(e){this._state=e}get state(){return this._state}set time(e){this._time=e}get time(){return this._time}set conditions(e){this._conditions=e}get conditions(){return this._conditions}}},function(e,t,s){"use strict";s.r(t);var r=s(132);t.default=class{constructor(e){this._type=e.type,this._props=new r.default[e.type](e.props)}set type(e){this._type=e}get type(){return this._type}set props(e){this._props=e}get props(){return this._props}}},function(e,t,s){"use strict";s.r(t);var r=s(133),i=s(137);t.default={comparator:r.default,message:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(134);t.default=class{constructor(e){this._operation=e.operation,this._arg1=new r.default[e.arg1.type](e.arg1),this._arg2=new r.default[e.arg2.type](e.arg2)}set operation(e){this._operation=e}get operation(){return this._operation}set arg1(e){this._arg1=e}get arg1(){return this._arg1}set arg2(e){this._arg2=e}get arg2(){return this._arg2}}},function(e,t,s){"use strict";s.r(t);var r=s(135),i=s(136);t.default={number:r.default,componentValue:i.default}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e){this._type=e.type,this._value=e.value}set type(e){this._type=e}get type(){return this._type}set value(e){this._value=e}get value(){return this._value}}},function(e,t,s){"use strict";s.r(t);const r=".";t.default=class{constructor(e){this._type=e.type,this._value=Array.isArray(e.value)?e.value.slice(0):e.value.split(r)}set type(e){this._type=e}get type(){return this._type}set value(e){this._value=e}get value(){return this._value}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e){this._message=e.message}set message(e){this._message=e}get message(){return this._message}}},function(e,t,s){"use strict";s.r(t);var r=s(139);t.default=class{constructor(e){this._frames=e.frames.map(e=>new r.default(e)),this._looped=e.looped}set frames(e){this._frames=e}get frames(){return this._frames}set looped(e){this._looped=e}get looped(){return this._looped}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e){this._index=e.index,this._rotation=e.rotation,this._flipX=e.flipX,this._flipY=e.flipY,this._disabled=e.disabled}set index(e){this._index=e}get index(){return this._index}set rotation(e){this._rotation=e}get rotation(){return this._rotation}set flipX(e){this._flipX=e}get flipX(){return this._flipX}set flipY(e){this._flipY=e}get flipY(){return this._flipY}set disabled(e){this._disabled=e}get disabled(){return this._disabled}}},function(e,t,s){"use strict";s.r(t);var r=s(129),i=s(141),n=s(142);t.default=class extends r.default{constructor(e){super(e),this._substates=e.substates.map(e=>new i.default(e)),this._pickMode=e.pickMode,this._pickProps=new n.default[e.pickMode](e.pickProps)}set substates(e){this._substates=e}get substates(){return this._substates}set pickMode(e){this._pickMode=e}get pickMode(){return this._pickMode}set pickProps(e){this._pickProps=e}get pickProps(){return this._pickProps}}},function(e,t,s){"use strict";s.r(t);var r=s(138);t.default=class{constructor(e){this._name=e.name,this._timeline=new r.default(e.timeline),this._x=e.x,this._y=e.y}set name(e){this._name=e}get name(){return this._name}set timeline(e){this._timeline=e}get timeline(){return this._timeline}set x(e){this._x=e}get x(){return this._x}set y(e){this._y=e}get y(){return this._y}}},function(e,t,s){"use strict";s.r(t);var r=s(143),i=s(144);t.default={"1D":r.default,"2D":i.default}},function(e,t,s){"use strict";s.r(t);const r=".";t.default=class{constructor(e){this._x=Array.isArray(e.x)?e.x.slice(0):e.x.split(r)}set x(e){this._x=e}get x(){return this._x}}},function(e,t,s){"use strict";s.r(t);const r=".";t.default=class{constructor(e){this._x=Array.isArray(e.x)?e.x.slice(0):e.x.split(r),this._y=Array.isArray(e.y)?e.y.slice(0):e.y.split(r)}set x(e){this._x=e}get x(){return this._x}set y(e){this._y=e}get y(){return this._y}}},function(e,t,s){"use strict";s.r(t);var r=s(32);class i extends r.default{constructor(e,t){super(e,t),this._src=t.src,this._width=t.width,this._height=t.height,this._type=t.type,this._slice=t.slice,this._spacing=t.spacing||0,this._extruding=t.extruding||0,this._currentFrame="sprite"===t.type?0:void 0,this._rotation=t.rotation,this._origin=t.origin,this._flipX=t.flipX,this._flipY=t.flipY,this._disabled=t.disabled,this._sortingLayer=t.sortingLayer}set src(e){this._src=e}get src(){return this._src}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set type(e){this._type=e}get type(){return this._type}set slice(e){this._slice=e}get slice(){return this._slice}set spacing(e){this._spacing=e}get spacing(){return this._spacing}set extruding(e){this._extruding=e}get extruding(){return this._extruding}set currentFrame(e){this._currentFrame=e}get currentFrame(){return this._currentFrame}set rotation(e){this._rotation=e}get rotation(){return this._rotation}set origin(e){this._origin=e}get origin(){return[this._origin[0]-this.width/2,this._origin[1]-this.height/2]}set flipX(e){this._flipX=e}get flipX(){return this._flipX}set flipY(e){this._flipY=e}get flipY(){return this._flipY}set disabled(e){this._disabled=e}get disabled(){return this._disabled}set sortingLayer(e){this._sortingLayer=e}get sortingLayer(){return this._sortingLayer}clone(){return new i(this.componentName,{src:this.src,width:this.width,height:this.height,type:this.type,slice:this.slice,spacing:this.spacing,extruding:this.extruding,rotation:this.rotation,origin:this._origin,flipX:this.flipX,flipY:this.flipY,disabled:this.disabled,sortingLayer:this.sortingLayer})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(32);class i extends r.default{constructor(e,t){super(e,t),this._offsetX=t.offsetX,this._offsetY=t.offsetY,this._offsetZ=t.offsetZ,this._rotation=t.rotation,this._scaleX=t.scaleX||1,this._scaleY=t.scaleY||1}_getPropertyFromParent(e,t){const s=this.getParentComponent();return s?s[e]:t}set offsetX(e){this._offsetX=e-this._getPropertyFromParent("offsetX",0)}get offsetX(){return this._offsetX+this._getPropertyFromParent("offsetX",0)}set offsetY(e){this._offsetY=e-this._getPropertyFromParent("offsetY",0)}get offsetY(){return this._offsetY+this._getPropertyFromParent("offsetY",0)}set offsetZ(e){this._offsetZ=e-this._getPropertyFromParent("offsetZ",0)}get offsetZ(){return this._offsetZ+this._getPropertyFromParent("offsetZ",0)}set rotation(e){this._rotation=e-this._getPropertyFromParent("rotation",0)}get rotation(){return this._rotation+this._getPropertyFromParent("rotation",0)}set scaleX(e){this._scaleX=e/this._getPropertyFromParent("scaleX",1)}get scaleX(){return this._scaleX*this._getPropertyFromParent("scaleX",1)}set scaleY(e){this._scaleY=e/this._getPropertyFromParent("scaleY",1)}get scaleY(){return this._scaleY*this._getPropertyFromParent("scaleY",1)}clone(){return new i(this.componentName,{offsetX:this.offsetX,offsetY:this.offsetY,offsetZ:this.offsetZ,rotation:this.rotation,scaleX:this.scaleX,scaleY:this.scaleY})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(32);class i extends r.default{constructor(e,t){super(e,t),this._inputEventBindings=t.inputEventBindings}set inputEventBindings(e){this._inputEventBindings=e}get inputEventBindings(){return this._inputEventBindings}clone(){return new i(this.componentName,{inputEventBindings:{...this.inputEventBindings}})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(32);class i extends r.default{constructor(e,t){super(e,t),this._name=t.name}set name(e){this._name=e}get name(){return this._name}clone(){return new i(this.componentName,{name:this.name})}}t.default=i},function(e){e.exports=JSON.parse('{"projectSettings":{},"scenes":{"game":"resources/configurations/scenes/game.json","mainMenu":"resources/configurations/scenes/mainMenu.json"},"prefabs":[{"src":"resources/configurations/prefabs/units/player.json"},{"src":"resources/configurations/prefabs/terrain/island.json"},{"src":"resources/configurations/prefabs/terrain/sea.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerTop.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerBottom.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerLeft.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerRight.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerTopLeft.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerTopRight.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerBottomRight.json"},{"src":"resources/configurations/prefabs/terrain/pathBlockerBottomLeft.json"},{"src":"resources/configurations/prefabs/zones/hit.json"},{"src":"resources/configurations/prefabs/units/enemy.json"},{"src":"resources/configurations/prefabs/units/rangeEnemy.json"},{"src":"resources/configurations/prefabs/items/healGrass.json"},{"src":"resources/configurations/prefabs/items/ogreGrass.json"},{"src":"resources/configurations/prefabs/items/boomGrass.json"},{"src":"resources/configurations/prefabs/items/energyBall.json"},{"src":"resources/configurations/prefabs/effects/fetter.json"},{"src":"resources/configurations/prefabs/effects/heal.json"},{"src":"resources/configurations/prefabs/effects/power.json"}],"startScene":"mainMenu"}')},function(e,t,s){"use strict";s.r(t);var r=s(151),i=s(153),n=s(155),o=s(169),a=s(171),c=s(173),h=s(182),u=s(184),l=s(190),d=s(192),_=s(208),g=s(211),f=s(213),p=s(215),m=s(217),b=s(219),v=s(221),O=s(223);t.default={autoAimingProcessor:r.default,damageProcessor:i.default,effectsProcessor:n.default,gameOverProcessor:o.default,reaper:a.default,fightSystem:c.default,enemySpawner:h.default,aiProcessor:u.default,enemiesDetector:l.default,customRenderer:d.default,dayNightSimulator:_.default,grassSpawner:g.default,collectProcessor:f.default,craftProcessor:p.default,itemsActivator:m.default,movementProcessor:b.default,thumbStickController:v.default,touchDeviceJammer:O.default}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(152);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="ATTACK",n="COLLISION_STAY",o="transform",a="viewDirection",c="aimRadius",h="hitBox";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver}process(e){const{messageBus:t}=e;this._gameObjectObserver.forEach(e=>{const{offsetX:s,offsetY:u}=e.getComponent(o),l=e.getComponent(a);(t.getById(i,e.getId())||[]).forEach(i=>{const{x:a,y:d}=i;if(void 0!==a&&void 0!==d)return;i.x=s+l.x,i.y=u+l.y;const _=e.getChildren().find(e=>e.getComponent(c));if(!_)return;let g;(t.getById(n,_.getId())||[]).forEach(t=>{const{gameObject2:n}=t,a=n.getComponent(h),c=n.parent;if(!a||e.getId()===c.getId())return;const{offsetX:l,offsetY:d}=n.getComponent(o),_=r.MathOps.getDistanceBetweenTwoPoints(s,l,u,d);(void 0===g||_<g)&&(i.x=l,i.y=d,g=_)})})})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(154);t.default=class extends r.ProcessorPlugin{async load(){return new i.default}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="DAMAGE",n="KILL",o="health";t.default=class extends r.Processor{process(e){const t=e.messageBus;(t.get(i)||[]).forEach(e=>{const{gameObject:s,value:r}=e,i=s.getComponent(o);i&&(i.points-=Math.round(r),i.points<=0&&(i.points=0,t.send({type:n,id:s.getId(),gameObject:s})))})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(156);t.default=class extends r.ProcessorPlugin{async load(e){const{helpers:t,gameObjectObserver:s,gameObjectSpawner:r}=e,{effects:n}=await t.loadEffects();return new i.EffectsProcessor({gameObjectObserver:s,gameObjectSpawner:r,effects:n})}}},function(e,t,s){"use strict";s.r(t);var r=s(157);s.d(t,"EffectsProcessor",function(){return r.EffectsProcessor});var i=s(168);s.d(t,"Effect",function(){return i.Effect})},function(e,t,s){"use strict";s.r(t),s.d(t,"EffectsProcessor",function(){return l});var r=s(1),i=s(158),n=s(159),o=s(164);function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const c="ADD_EFFECT",h="REMOVE_EFFECT",u="KILL";class l extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._gameObjectSpawner=e.gameObjectSpawner,this._actions=e.effects,this._applicatorsMap={}}_killEffect(e,t){t.send({type:u,id:e.getId(),gameObject:e})}_cancelEffect(e,t,s){const r=t.getId();if(!this._applicatorsMap[r]||!this._applicatorsMap[r][e])return;this._applicatorsMap[r][e].cancel(),this._applicatorsMap[r][e]=null;const i=t.getComponent(o.ACTIVE_EFFECTS_COMPONENT_NAME);i.list=i.list.filter(t=>e!==t||(this._killEffect(i.map[t],s),i.map[t]=null,!1))}_addEffect(e,t,s,r){const c=t.getId(),h=this._gameObjectSpawner.spawn(e);t.appendChild(h);const{action:u,type:l,options:d}=h.getComponent(o.EFFECT_COMPONENT_NAME);t.getComponent(o.ACTIVE_EFFECTS_COMPONENT_NAME)||t.setComponent(o.ACTIVE_EFFECTS_COMPONENT_NAME,new i.ActiveEffects);const _=t.getComponent(o.ACTIVE_EFFECTS_COMPONENT_NAME);_.list.push(e),_.map[e]=h;const g=this._actions[u],f=new(0,n.default[l])(new g(t,r,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),r.forEach(function(t){a(e,t,s[t])})}return e}({},d,s)),h,r);this._applicatorsMap[c]=this._applicatorsMap[c]||{},this._applicatorsMap[c][e]=f}_processNewEffects(e){(e.get(c)||[]).forEach(t=>{const{name:s,options:r,gameObject:i}=t;this._cancelEffect(s,i,e),this._addEffect(s,i,r,e)})}_processEffectsCancellation(e){(e.get(h)||[]).forEach(t=>{const{name:s,gameObject:r}=t;this._cancelEffect(s,r,e)})}_processRemovedGameObjects(){this._gameObjectObserver.getLastRemoved().forEach(e=>{const t=e.getId();Object.keys(this._applicatorsMap[t]||{}).forEach(e=>{this._applicatorsMap[t][e]=null})})}process(e){const t=e.messageBus,s=e.deltaTime;this._processRemovedGameObjects(),this._processNewEffects(t),this._processEffectsCancellation(t),this._gameObjectObserver.forEach(e=>{const r=e.getId(),i=e.getComponent(o.ACTIVE_EFFECTS_COMPONENT_NAME);i.list=i.list.filter(e=>{const n=this._applicatorsMap[r][e];return n.update(s),!n.isFinished()||(n.cancel(),this._killEffect(i.map[e],t),i.map[e]=null,this._applicatorsMap[r][e]=null,!1)})})}}},function(e,t,s){"use strict";s.r(t),s.d(t,"ActiveEffects",function(){return n});var r=s(1);function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n extends r.Component{constructor(e,t){super(e,t),this._list=t?[...t.list]:[],this._map=t?function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),r.forEach(function(t){i(e,t,s[t])})}return e}({},t.map):{}}set list(e){this._list=e}get list(){return this._list}set map(e){this._map=e}get map(){return this._map}clone(){return new n(this.componentName,{list:this.list,map:this.map})}}},function(e,t,s){"use strict";s.r(t);var r=s(160),i=s(163),n=s(165),o=s(166),a=s(167);t.default={instant:r.default,delayed:i.default,periodical:n.default,continuous:o.default,timeLimited:a.default}},function(e,t,s){"use strict";s.r(t);var r=s(161);t.default=class extends r.default{constructor(...e){super(...e),this._isFinished=!1}update(){this._isFinished||(this._action.apply(),this._handleApply(),this._isFinished=!0)}cancel(){this._handleCancel()}isFinished(){return this._isFinished}}},function(e,t,s){"use strict";s.r(t);var r=s(162);t.default=class{constructor(e,t,s){this._action=e,this._effect=t,this._messageBus=s,this._messageBus.send({type:r.EFFECT_ADD_MSG,id:this._effect.getId(),gameObject:this._effect})}_handleCancel(){this._messageBus.send({type:r.EFFECT_CANCEL_MSG,id:this._effect.getId(),gameObject:this._effect})}_handleApply(){this._messageBus.send({type:r.EFFECT_APPLY_MSG,id:this._effect.getId(),gameObject:this._effect})}update(){throw new Error("You should override this function")}isFinished(){throw new Error("You should override this function")}cancel(){}}},function(e,t,s){"use strict";s.r(t),s.d(t,"EFFECT_ADD_MSG",function(){return r}),s.d(t,"EFFECT_APPLY_MSG",function(){return i}),s.d(t,"EFFECT_CANCEL_MSG",function(){return n});const r="EFFECT_ADD",i="EFFECT_APPLY",n="EFFECT_CANCEL"},function(e,t,s){"use strict";s.r(t);var r=s(161),i=s(164);t.default=class extends r.default{constructor(...e){super(...e),this._isFinished=!1}update(e){if(this._isFinished)return;const{applicatorOptions:t}=this._effect.getComponent(i.EFFECT_COMPONENT_NAME);t.timer-=e,t.timer<=0&&(this._action.apply(),this._handleApply(),this._isFinished=!0)}cancel(){this._handleCancel()}isFinished(){return this._isFinished}}},function(e,t,s){"use strict";s.r(t),s.d(t,"EFFECT_COMPONENT_NAME",function(){return r}),s.d(t,"ACTIVE_EFFECTS_COMPONENT_NAME",function(){return i});const r="effect",i="activeEffects"},function(e,t,s){"use strict";s.r(t);var r=s(161),i=s(164);t.default=class extends r.default{constructor(...e){super(...e),this._isFinished=!1}update(e){if(this._isFinished)return;const{applicatorOptions:t}=this._effect.getComponent(i.EFFECT_COMPONENT_NAME);for(t.cooldown-=e;t.cooldown<=0;)this._action.apply(),this._handleApply(),t.cooldown+=t.frequency;t.duration&&(t.duration-=e,t.duration<=0&&(this._isFinished=!0))}cancel(){this._handleCancel()}isFinished(){return this._isFinished}}},function(e,t,s){"use strict";s.r(t);var r=s(161);t.default=class extends r.default{constructor(...e){super(...e),this._isApplied=!1}update(){this._isApplied||(this._action.apply(),this._handleApply(),this._isApplied=!0)}cancel(){this._isApplied&&(this._action.onCancel(),this._handleCancel())}isFinished(){return!1}}},function(e,t,s){"use strict";s.r(t);var r=s(161),i=s(164);t.default=class extends r.default{constructor(...e){super(...e),this._isApplied=!1,this._isFinished=!1}update(e){if(this._isFinished)return;const{applicatorOptions:t}=this._effect.getComponent(i.EFFECT_COMPONENT_NAME);t.duration-=e,t.duration<=0?this._isFinished=!0:this._isApplied||(this._action.apply(),this._handleApply(),this._isApplied=!0)}cancel(){this._isApplied&&(this._action.onCancel(),this._handleCancel())}isFinished(){return this._isFinished}}},function(e,t,s){"use strict";s.r(t),s.d(t,"Effect",function(){return r});class r{apply(){throw new Error("You should override this function")}onCancel(){}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(170);t.default=class extends r.ProcessorPlugin{async load(e){const{gameObjectObserver:t}=e;return new i.default({gameObjectObserver:t})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="keyboardControl",n="DEATH",o="DEFEAT";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._playerGameObjects=new Set,this._isGameOver=!1}_processAddedGameObjects(){this._gameObjectObserver.getLastAdded().forEach(e=>{const t=e.getId();e.getComponent(i)&&this._playerGameObjects.add(t)})}process(e){const t=e.messageBus;this._isGameOver||(this._processAddedGameObjects(),(t.get(n)||[]).forEach(e=>{const{gameObject:t}=e;this._playerGameObjects.delete(t.getId())}),0===this._playerGameObjects.size&&(t.send({type:o}),this._isGameOver=!0))}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(172);t.default=class extends r.ProcessorPlugin{async load(e){const{gameObjectObserver:t,gameObjectDestroyer:s,allowedComponents:r,lifetime:n}=e;return new i.default({gameObjectObserver:t,gameObjectDestroyer:s,allowedComponents:r,lifetime:n})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="KILL",n="DEATH",o=1e3;t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._gameObjectDestroyer=e.gameObjectDestroyer,this._allowedComponents=e.allowedComponents.reduce((e,t)=>(e[t]=!0,e),{}),this._lifetime=e.lifetime,this._graveyard=[],this._timeCounter=0}_killGameObject(e,t){e.getComponentNamesList().forEach(t=>{this._allowedComponents[t]||e.removeComponent(t)}),this._graveyard.push({gameObject:e,lifetime:this._lifetime}),t.send({type:n,id:e.getId(),gameObject:e}),e.getChildren().forEach(e=>this._killGameObject(e,t))}process(e){const{messageBus:t,deltaTime:s}=e;(t.get(i)||[]).forEach(e=>{const{gameObject:s}=e;this._killGameObject(s,t)}),this._timeCounter+=s,this._timeCounter>=o&&(this._graveyard=this._graveyard.filter(e=>(e.lifetime-=this._timeCounter,!(e.lifetime<=0&&(this._gameObjectDestroyer.destroy(e.gameObject),1)))),this._timeCounter=0)}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(174);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectSpawner:e.gameObjectSpawner,gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(175);const n="ATTACK",o="transform";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._gameObjectSpawner=e.gameObjectSpawner,this._fighters={},this._activeAttacks=[]}_processActiveAttacks(e){this._activeAttacks=this._activeAttacks.filter(t=>(t.process(e),!t.isFinished()))}_attack(e,t,s,i){const a=e.getId(),{offsetX:c,offsetY:h}=e.getComponent(o),u=this._fighters[a];if(!u||!u.isReady())return void i.deleteById(n,a);const l=r.MathOps.getAngleBetweenTwoPoints(t,c,s,h),d=u.attack(l);this._activeAttacks.push(d)}_processFighters(e,t){this._gameObjectObserver.forEach(s=>{const r=s.getId();this._fighters[r]?this._fighters[r].process(e):this._fighters[r]=new i.SimpleFighter(s,this._gameObjectSpawner,t)})}_processRemovedFighters(){this._gameObjectObserver.getLastRemoved().forEach(e=>{const t=e.getId();this._fighters[t]=null})}process(e){const{messageBus:t,deltaTime:s}=e;this._processRemovedFighters(),this._processFighters(s,t),this._processActiveAttacks(s),(t.get(n)||[]).forEach(e=>{const{gameObject:s,x:r,y:i}=e;this._attack(s,r,i,t)})}}},function(e,t,s){"use strict";s.r(t);var r=s(176);s.d(t,"SimpleFighter",function(){return r.default})},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(177),n=s(178);const o="weapon",a="viewDirection",c=250;t.default=class extends i.default{constructor(e,t,s){super(),this._gameObject=e,this._spawner=t,this._messageBus=s,this._weapon=this._gameObject.getComponent(o),this._weapon.cooldownRemaining=0,this._viewDirection=null,this._viewTimer=0}isReady(){return this._weapon.cooldownRemaining<=0}attack(e){if(!this.isReady())return;const{type:t,cooldown:s}=this._weapon,i=n.default[t];if(!i)throw new Error(`Not found attack with same type: ${t}`);return this._weapon.cooldownRemaining=s,this._viewDirection=r.VectorOps.getVectorByAngle(e),this._viewTimer=c,new i(this._gameObject,this._spawner,this._messageBus,e)}process(e){if(this._weapon.cooldownRemaining-=e,this._viewTimer>0){this._viewTimer-=e;const t=this._gameObject.getComponent(a);t.x=this._viewDirection.x,t.y=this._viewDirection.y}}}},function(e,t,s){"use strict";s.r(t);t.default=class{isReady(){throw new Error("You should override this function")}attack(){throw new Error("You should override this function")}process(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(179),i=s(181);t.default={melee:r.default,range:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(180);const n="DAMAGE",o="COLLISION_ENTER",a="ADD_EFFECT",c="ADD_IMPULSE",h="hit",u="weapon",l="transform",d="colliderContainer",_="health",g="hitBox",f=100,p=200;t.default=class extends i.default{constructor(e,t,s,i){super(),this._gameObject=e,this._spawner=t,this._messageBus=s,this._angle=i,this._weapon=this._gameObject.getComponent(u);const{offsetX:n,offsetY:o}=this._gameObject.getComponent(l),{range:a}=this._weapon.properties,c=r.MathOps.radToDeg(this._angle),_=this._spawner.spawn(h),g=_.getComponent(l),m=_.getComponent(d).collider;m.radius=a/2;const b=r.MathOps.getLinePoint(c+180,n,o,m.radius);g.offsetX=b.x,g.offsetY=b.y;const v=r.VectorOps.getVectorByAngle(this._angle);v.multiplyNumber(p),this._directionVector=v,this._hit=_,this._lifetime=f,this._isFinished=!1}isFinished(){return this._isFinished}process(e){if(this._isFinished)return;const t=this._hit.getId(),{damage:s}=this._weapon.properties;if((this._messageBus.getById(o,t)||[]).forEach(e=>{const{gameObject2:r}=e,i=r.getComponent(g),o=r.parent;if(!i||!o)return;const h=o.getId();this._gameObject.getId()!==h&&t!==h&&(this._messageBus.send({type:n,id:h,gameObject:o,value:s}),this._messageBus.send({type:a,id:h,gameObject:o,name:"fetter"}),this._messageBus.send({type:c,value:this._directionVector.clone(),gameObject:o,id:h}))}),this._lifetime-=e,this._lifetime<=0){const e=this._hit.getComponent(_);this._messageBus.send({type:n,id:t,gameObject:this._hit,value:e.points}),this._isFinished=!0}}}},function(e,t,s){"use strict";s.r(t);t.default=class{isFinished(){throw new Error("You should override this function")}process(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(180);const n="DAMAGE",o="COLLISION_ENTER",a="ADD_EFFECT",c="ADD_IMPULSE",h="weapon",u="transform",l="colliderContainer",d="health",_="hitBox";t.default=class extends i.default{constructor(e,t,s,i){super(),this._gameObject=e,this._spawner=t,this._messageBus=s,this._angle=i,this._weapon=this._gameObject.getComponent(h);const{offsetX:n,offsetY:o}=this._gameObject.getComponent(u),{range:a,projectileSpeed:d,projectileModel:_,projectileRadius:g}=this._weapon.properties,f=this._spawner.spawn(_),p=f.getComponent(u);f.getComponent(l).collider.radius=g,p.offsetX=n,p.offsetY=o,p.rotation=r.MathOps.radToDeg(this._angle);const m=r.VectorOps.getVectorByAngle(this._angle);m.multiplyNumber(d);const b=1e3*a/d;this._messageBus.send({type:c,id:f.getId(),gameObject:f,value:m.clone()}),this._directionVector=m,this._shot=f,this._lifetime=b,this._isFinished=!1}isFinished(){return this._isFinished}process(e){if(this._isFinished)return;const t=this._shot.getId();if(!this._shot.getComponent(d))return void(this._isFinished=!0);const{damage:s}=this._weapon.properties;if((this._messageBus.getById(o,t)||[]).some(e=>{const{gameObject2:r}=e,i=r.getComponent(_),o=r.parent;if(!i||!o)return!1;const h=o.getId();return this._gameObject.getId()!==h&&t!==h&&(this._messageBus.send({type:n,id:h,gameObject:o,value:s}),this._messageBus.send({type:a,id:h,gameObject:o,name:"fetter"}),this._messageBus.send({type:c,value:this._directionVector.clone(),gameObject:o,id:h}),this._lifetime=0,!0)}),this._lifetime-=e,this._lifetime<=0){const e=this._shot.getComponent(d);this._messageBus.send({type:n,id:t,gameObject:this._shot,value:e.points}),this._isFinished=!0}}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(183);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectSpawner:e.gameObjectSpawner,gameObjectObserver:e.gameObjectObserver,store:e.store})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="DAMAGE",n="enemy",o="rangeEnemy",a="transform",c="weapon",h="health",u=2e3,l=4e3,d=0,_=9,g=1e4,f=2,p=5,m=4,b=2,v="timeOfDay";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._gameObjectSpawner=e.gameObjectSpawner,this._store=e.store,this._islandSize={minX:-200,maxX:200,minY:-200,maxY:200},this._enemyCooldown=0,this._rangeEnemyCooldown=0}_spawnMeleeEnemies(e,t,s){if(this._enemyCooldown>0)this._enemyCooldown-=e;else if(t>=d&&t<_){const e=this._gameObjectSpawner.spawn(n),t=e.getComponent(a),i=e.getComponent(c),o=e.getComponent(h);i.properties.damage+=s*f,o.maxPoints+=s*p,o.points+=s*p,t.offsetX=r.MathOps.random(this._islandSize.minX,this._islandSize.maxX),t.offsetY=r.MathOps.random(this._islandSize.minY,this._islandSize.maxY),this._enemyCooldown=u}}_spawnRangeEnemies(e,t,s){if(this._rangeEnemyCooldown>0)this._rangeEnemyCooldown-=e;else if(t>=d&&t<_){const e=this._gameObjectSpawner.spawn(o),t=e.getComponent(a),i=e.getComponent(c),n=e.getComponent(h);i.properties.damage+=s*m,n.maxPoints+=s*b,n.points+=s*b,t.offsetX=r.MathOps.random(this._islandSize.minX,this._islandSize.maxX),t.offsetY=r.MathOps.random(this._islandSize.minY,this._islandSize.maxY),this._rangeEnemyCooldown=l}}process(e){const{messageBus:t,deltaTime:s}=e,r=this._store.get(v),n=r.getHours(),o=r.getDays()-1;this._spawnMeleeEnemies(s,n,o),this._spawnRangeEnemies(s,n,o),this._gameObjectObserver.size()&&n>=_&&this._gameObjectObserver.forEach(e=>{t.send({type:i,id:e.getId(),gameObject:e,value:g})})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(185);t.default=class extends r.ProcessorPlugin{async load(e){const{gameObjectObserver:t,store:s}=e;return new i.default({gameObjectObserver:t,store:s})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(186);const n="ai";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._store=e.store,this.playersStrategies={}}_processAddedGameObjects(){this._gameObjectObserver.getLastAdded().forEach(e=>{const t=e.getId(),s=e.getComponent(n);this.playersStrategies[t]=new i.default[s.strategy](e,this._store)})}process(e){const{messageBus:t,deltaTime:s}=e;this._processAddedGameObjects(),this._gameObjectObserver.forEach(e=>{const r=e.getId();this.playersStrategies[r].update(t,s)})}}},function(e,t,s){"use strict";s.r(t);var r=s(187),i=s(189);t.default={enemy:r.default,rangeEnemy:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(188);const n="ATTACK",o="MOVEMENT",a="player",c="transform",h="weapon",u=1e3,l=500,d=20;t.default=class extends i.default{constructor(e,t){super(),this._player=e,this._store=t,this._playerId=this._player.getId(),this._cooldown=u,this._distance=null,this._isMeleeEnemy=!1,this._prepareToAttack=!1}_updateDistances(){if(this._prepareToAttack)return;const e=this._store.get(a);if(!e)return;const{offsetX:t,offsetY:s}=this._player.getComponent(c),{offsetX:i,offsetY:n}=e.getComponent(c);this._distance=r.MathOps.getDistanceBetweenTwoPoints(i,t,n,s)}_updateMeleeEnemies(){const e=this._player.getComponent(h);this._prepareToAttack||e.cooldownRemaining>0||(this._isMeleeEnemy=this._distance<=d,this._isMeleeEnemy&&(this._cooldown=l,this._prepareToAttack=!0))}_attack(e){if(!this._isMeleeEnemy||this._cooldown>0)return;if(this._player.getComponent(h).cooldownRemaining>0)return;const t=this._store.get(a);if(!t)return;const{offsetX:s,offsetY:r}=t.getComponent(c);e.send({gameObject:this._player,id:this._player.getId(),type:n,x:s,y:r}),this._prepareToAttack=!1}_move(e){if(this._isMeleeEnemy||this._prepareToAttack||this._cooldown>0)return;const t=this._store.get(a);if(!t)return;const{offsetX:s,offsetY:i}=t.getComponent(c),{offsetX:n,offsetY:h}=this._player.getComponent(c),u=r.MathOps.radToDeg(r.MathOps.getAngleBetweenTwoPoints(s,n,i,h));e.send({type:o,gameObject:this._player,id:this._player.getId(),angle:u})}update(e,t){this._cooldown-=t,this._updateDistances(),this._updateMeleeEnemies(),this._attack(e),this._move(e)}}},function(e,t,s){"use strict";s.r(t);t.default=class{update(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(188);const n="ATTACK",o="MOVEMENT",a="player",c="transform",h="weapon",u="colliderContainer",l=1e3,d=1,_=50,g=100;t.default=class extends i.default{constructor(e,t){super(),this._player=e,this._store=t,this._playerId=this._player.getId(),this._cooldown=r.MathOps.random(0,l),this._waypoint=null,this._enemy=null,this._meleeEnemy=null,this._distance=null,this._islandSize={minX:-200,maxX:200,minY:-200,maxY:200}}_getMovementBoundaries(){const{collider:e}=this._player.getComponent(u),{centerX:t,centerY:s}=e;return{minX:this._islandSize.minX-t,maxX:this._islandSize.maxX-t,minY:this._islandSize.minY-s,maxY:this._islandSize.maxY-s}}_updateDistances(){const e=this._store.get(a);if(!e)return;const{offsetX:t,offsetY:s}=this._player.getComponent(c),{offsetX:i,offsetY:n}=e.getComponent(c);this._distance=r.MathOps.getDistanceBetweenTwoPoints(i,t,n,s)}_updateMeleeEnemies(){const e=this._store.get(a);e&&(this._meleeEnemy=this._distance<=_?e:null)}_updateTargetEnemy(){this._store.get(a)?this._enemy=this._store.get(a):this._enemy=null}_findWayToRetreat(){let e;const{minX:t,maxX:s,minY:i,maxY:n}=this._getMovementBoundaries(),{offsetX:o,offsetY:h}=this._player.getComponent(c),u=this._store.get(a);if(!this._meleeEnemy||!u)return;const{offsetX:l,offsetY:d}=u.getComponent(c);e=(r.MathOps.radToDeg(r.MathOps.getAngleBetweenTwoPoints(o,l,h,d))+180)%360;const _=r.MathOps.getLinePoint(e,o,h,g);return _.x>t&&_.x<s&&_.y>i&&_.y<n?_:void 0}_updateWaypoint(){const{minX:e,maxX:t,minY:s,maxY:i}=this._getMovementBoundaries(),n=this._findWayToRetreat();this._waypoint=n||{x:r.MathOps.random(e,t),y:r.MathOps.random(s,i)}}_attack(e){const t=this._player.getComponent(h),{range:s}=t.properties;if(t.cooldownRemaining>0||!this._enemy||s<this._distance)return;const{offsetX:r,offsetY:i}=this._enemy.getComponent(c);e.send({gameObject:this._player,id:this._player.getId(),type:n,x:r,y:i})}_move(e){if(!this._waypoint)return;const{offsetX:t,offsetY:s}=this._player.getComponent(c),{x:i,y:n}=this._waypoint;if(Math.abs(i-t)<d&&Math.abs(n-s)<d)return void(this._waypoint=null);const a=r.MathOps.radToDeg(r.MathOps.getAngleBetweenTwoPoints(this._waypoint.x,t,this._waypoint.y,s));e.send({type:o,gameObject:this._player,id:this._player.getId(),angle:a})}update(e,t){this._cooldown-=t,this._cooldown<=0&&(this._updateDistances(),this._updateTargetEnemy(),this._updateWaypoint(),this._cooldown+=l),this._attack(e),this._move(e)}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(191);t.default=class extends r.ProcessorPlugin{async load(e){const{gameObjectObserver:t,store:s}=e;return new i.default({gameObjectObserver:t,store:s})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="keyboardControl",n="player";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._store=e.store,this._playersCount=0}_scan(){this._playersCount=this._gameObjectObserver.size(),this._store.set(n,null),this._gameObjectObserver.forEach(e=>{e.getComponent(i)&&this._store.set(n,e)})}processorDidMount(){this._scan()}process(){this._playersCount!==this._gameObjectObserver.size()&&this._scan()}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(193);t.default=class extends r.ProcessorPlugin{async load(e){const t=r.IOC.resolve(r.RESOURCES_LOADER_KEY_NAME),{windowNodeId:s,textureAtlas:n,textureAtlasDescriptor:o,backgroundColor:a,sortingLayers:c,scaleSensitivity:h,gameObjectObserver:u,store:l}=e,d=document.getElementById(s),_=[n,o],g=await Promise.all(_.map(e=>t.load(e)));return new i.default({window:d,textureAtlas:g[0],textureAtlasDescriptor:g[1],backgroundColor:a,sortingLayers:c,scaleSensitivity:h,gameObjectObserver:u,store:l})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(194),n=s(195),o=s(200),a=s(204),c=s(207);const h=255,u=0,l=6,d=1080,_=2,g=Float32Array.BYTES_PER_ELEMENT*_,f=3,p=3*f,m=Float32Array.BYTES_PER_ELEMENT*p,b=Float32Array.BYTES_PER_ELEMENT*f,v=5*_+p,O=v*l,y=1e3*O*Float32Array.BYTES_PER_ELEMENT,E="renderable",w="transform",x="camera",C="currentCamera",S="SET_COLOR_FILTER";t.default=class extends r.Processor{constructor(e){super();const{window:t,textureAtlas:s,textureAtlasDescriptor:r,backgroundColor:i,gameObjectObserver:a,sortingLayers:h,store:u,scaleSensitivity:l}=e;this.textureAtlas=s,this.textureAtlasSize={width:this.textureAtlas.width,height:this.textureAtlas.height},this.textureAtlasDescriptor=r,this.textureHandlers=Object.keys(o.default).reduce((e,t)=>{const s=o.default[t];return e[t]=new s,e},{}),this._matrixTransformer=new c.default,this._backgroundColor=new n.default(i),this._view=t,this._viewWidth,this._viewHeight,this._windowDidResize=!0,this._onWindowResize=this._onWindowResize.bind(this),this._shaders=[],this._sortingLayer=h.reduce((e,t,s)=>(e[t]=s,e),{}),this._store=u,this._gameObjectObserver=a,this._scaleSensitivity=Math.min(Math.max(l,0),100)/100,this._screenScale=1,this._vaoExt=null,this._buffer=null,this._vao=null,this._geometry={},this._viewMatrixStats={},this._vertexData=null,this._gameObjectsCount=0}processorDidMount(){window.addEventListener("resize",this._onWindowResize),this.gl=this._initGraphicContext(),this._initExtensions(),this._initScreen(),this.program=this._initShaders(),this._initProgramInfo(),this.textures=this._initTextures()}processorWillUnmount(){window.removeEventListener("resize",this._onWindowResize),this._shaders.forEach(e=>{this.gl.detachShader(this.program,e),this.gl.deleteShader(e)}),this.gl.deleteProgram(this.program),this.gl.deleteTexture(this.textures),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this._buffer=null,this._shaders=[],this.program=null,this.textures=null,this.gl=null,this._vao=null,this._vaoExt=null,this._geometry={},this._viewMatrixStats={},this._vertexData=null,this._gameObjectsCount=0}_onWindowResize(){this._windowDidResize=!0}_initGraphicContext(){let e=null;try{e=this._view.getContext("webgl")||this._view.getContext("experimental-webgl")}catch(e){throw new Error("Unable to get graphic context.")}if(!e)throw new Error("Unable to initialize WebGL. Your browser may not support it.");return e}_initExtensions(){if(this._vaoExt=this.gl.getExtension("OES_vertex_array_object"),!this._vaoExt)return alert("Unable to initialize OES_vertex_array_object extension")}_initScreen(){this.gl.clearColor(this._backgroundColor.red()/h,this._backgroundColor.green()/h,this._backgroundColor.blue()/h,1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.depthFunc(this.gl.LEQUAL),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}_initShaders(){const e=new a.default(this.gl),t=e.create(e.VERTEX_SHADER),s=e.create(e.FRAGMENT_SHADER),r=this.gl.createProgram();if(this.gl.attachShader(r,t),this.gl.attachShader(r,s),this.gl.linkProgram(r),!this.gl.getProgramParameter(r,this.gl.LINK_STATUS))throw new Error("Unable to initialize the shader program.");return this._shaders.push(t,s),r}_initProgramInfo(){this.gl.useProgram(this.program),this._variables={aPosition:this.gl.getAttribLocation(this.program,"a_position"),aTexCoord:this.gl.getAttribLocation(this.program,"a_texCoord"),aModelViewMatrix:this.gl.getAttribLocation(this.program,"a_modelViewMatrix"),aTexSize:this.gl.getAttribLocation(this.program,"a_texSize"),aTexTranslate:this.gl.getAttribLocation(this.program,"a_texTranslate"),aGameObjectSize:this.gl.getAttribLocation(this.program,"a_gameObjectSize"),uViewMatrix:this.gl.getUniformLocation(this.program,"u_viewMatrix"),uTexAtlasSize:this.gl.getUniformLocation(this.program,"u_texAtlasSize"),uColorFilterMatrix:this.gl.getUniformLocation(this.program,"u_colorFilterMatrix")},this._buffer=this.gl.createBuffer(),this._vao=this._createVAO(),this._setUpGlobalUniforms()}_createVAO(){const e=this._vaoExt.createVertexArrayOES();this._vaoExt.bindVertexArrayOES(e),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this._buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,y,this.gl.DYNAMIC_DRAW);const t=[{loc:this._variables.aPosition,type:"vec2"},{loc:this._variables.aTexCoord,type:"vec2"},{loc:this._variables.aModelViewMatrix,type:"mat3"},{loc:this._variables.aTexSize,type:"vec2"},{loc:this._variables.aTexTranslate,type:"vec2"},{loc:this._variables.aGameObjectSize,type:"vec2"}],s={mat3:m,vec2:g},r=t.reduce((e,t)=>e+s[t.type],0);let i=0;for(let e=0;e<t.length;e++)if("vec2"===t[e].type)this.gl.enableVertexAttribArray(t[e].loc),this.gl.vertexAttribPointer(t[e].loc,_,this.gl.FLOAT,!1,r,i),i+=g;else if("mat3"===t[e].type){for(let s=0;s<f;s++){const n=t[e].loc+s;this.gl.enableVertexAttribArray(n),this.gl.vertexAttribPointer(n,f,this.gl.FLOAT,!1,r,i+s*b)}i+=m}return this._vaoExt.bindVertexArrayOES(null),e}_setUpGlobalUniforms(){this.gl.uniform2fv(this._variables.uTexAtlasSize,[this.textureAtlasSize.width,this.textureAtlasSize.height])}_initTextures(){const e=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.textureAtlas),e}_getModelViewMatrix(e,t,s,r){const i=this._matrixTransformer,n=i.getIdentityMatrix();return i.translate(n,e.origin[0],e.origin[1]),e.flipX&&i.flipX(n),e.flipY&&i.flipY(n),i.rotate(n,(e.rotation+r)%360),i.translate(n,t,s),n}_getCompareFunction(){return(e,t)=>{const s=e.getComponent(E),r=t.getComponent(E),i=this._sortingLayer[s.sortingLayer],n=this._sortingLayer[r.sortingLayer];if(i>n)return 1;if(i<n)return-1;const o=e.getComponent(w),a=t.getComponent(w),c=o.offsetY+s.height/2,h=a.offsetY+r.height/2;if(c>h)return 1;if(c<h)return-1;const u=o.offsetX+s.width/2,l=a.offsetX+r.width/2;return u>l?1:u<l?-1:o.offsetZ-a.offsetZ}}_setUpTextureInfo(e,t,s){this._vertexData[s]=e.width,this._vertexData[s+1]=e.height,this._vertexData[s+2]=e.x,this._vertexData[s+3]=e.y,this._vertexData[s+4]=t.width,this._vertexData[s+5]=t.height}_setUpMatrix(e,t){this._vertexData[t]=e[0],this._vertexData[t+1]=e[1],this._vertexData[t+2]=e[2],this._vertexData[t+3]=e[3],this._vertexData[t+4]=e[4],this._vertexData[t+5]=e[5],this._vertexData[t+6]=e[6],this._vertexData[t+7]=e[7],this._vertexData[t+8]=e[8]}_setUpVertexData(e,t){const s=e.getId(),r=e.getComponent(E),n=t*O;if(r.disabled){for(let e=0;e<O;e++)this._vertexData[n+e]=0;return}const o=e.getComponent(w),a=this.textureAtlasDescriptor[r.src],c=this.textureHandlers[r.type].handle(a,r),h=this._getModelViewMatrix(r,o.offsetX,o.offsetY,o.rotation);this._geometry[s]||(this._geometry[s]={position:new i.default(r.width,r.height).toArray(),texCoord:new i.default(c.width,c.height).toArray()});const u=this._geometry[s].position,l=this._geometry[s].texCoord;for(let e=0,t=n;e<u.length;e+=2,t+=v)this._vertexData[t]=u[e],this._vertexData[t+1]=u[e+1],this._vertexData[t+2]=l[e],this._vertexData[t+3]=l[e+1],this._setUpMatrix(h,t+2*_),this._setUpTextureInfo(c,r,t+2*_+p)}_resizeCanvas(e){if(!this._windowDidResize)return;const t=window.devicePixelRatio||1;this._viewWidth=this._view.clientWidth,this._viewHeight=this._view.clientHeight;const s=this._viewWidth*t,r=this._viewHeight*t;e.width=s,e.height=r;const i=Math.sqrt(Math.pow(e.clientWidth,2)+Math.pow(e.clientHeight,2)),n=1-this._scaleSensitivity,o=i-(i-d)*n;this._screenScale=o/d,this.gl.viewport(0,0,s,r),this._windowDidResize=!1}_updateViewMatrix(){const e=this._store.get(C),t=e.getComponent(w),{zoom:s}=e.getComponent(x),r=s*this._screenScale,i=this._viewMatrixStats;if(i.x===t.offsetX&&i.y===t.offsetY&&i.width===this._viewWidth&&i.height===this._viewHeight&&i.scale===r)return;const n=this._matrixTransformer,o=n.getIdentityMatrix();n.translate(o,-t.offsetX,-t.offsetY),n.scale(o,r,r),n.project(o,this._viewWidth,this._viewHeight),this.gl.uniformMatrix3fv(this._variables.uViewMatrix,!1,o),this._viewMatrixStats.width=this._viewWidth,this._viewMatrixStats.height=this._viewHeight,this._viewMatrixStats.x=t.offsetX,this._viewMatrixStats.y=t.offsetY,this._viewMatrixStats.scale=r}_allocateVertexData(){const e=this._gameObjectObserver.size();this._gameObjectsCount!==e&&(this._gameObjectsCount=e,this._vertexData=new Float32Array(this._gameObjectsCount*O))}_setUpBuffers(){this._vaoExt.bindVertexArrayOES(this._vao),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this._vertexData)}_processRemovedGameObjects(){this._gameObjectObserver.getLastRemoved().forEach(e=>{const t=e.getId();this._geometry[t]=null})}_processColorFilters(e){const t=e.get(S)||[];t.length&&this.gl.uniformMatrix4fv(this._variables.uColorFilterMatrix,!1,t[t.length-1].filter)}process(e){const{messageBus:t}=e,s=this.gl.canvas;this._resizeCanvas(s),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this._processRemovedGameObjects(),this._processColorFilters(t),this._updateViewMatrix(),this._allocateVertexData(),this._gameObjectObserver.sort(this._getCompareFunction()),this._gameObjectObserver.forEach((e,t)=>{this._setUpVertexData(e,t)}),this._setUpBuffers(),this.gl.drawArrays(this.gl.TRIANGLES,u,l*this._gameObjectObserver.size())}}},function(e,t,s){"use strict";s.r(t);t.default=class{constructor(e,t){this._width=e,this._height=t}toArray(){const e=0+this._width,t=0+this._height;return[0,0,e,0,0,t,0,t,e,0,e,t]}}},function(e,t,s){"use strict";s.r(t);var r=s(196);const i=/#[0-9a-zA-Z]{6}/,n=/#[0-9a-zA-Z]{3}/,o="red",a="green",c="blue";t.default=class{constructor(e){const t=[{regexp:i,reader:r.default.hexColorReader},{regexp:n,reader:r.default.shortHeColorReader}];if(this._color=void 0,t.some(t=>{if(e.match(t.regexp)){const s=t.reader;return this._color=(new s).read(e),!0}}),!this._color)throw new Error("Error while color initialization: unknown type of color presentation")}red(){return this._color[o]}green(){return this._color[a]}blue(){return this._color[c]}}},function(e,t,s){"use strict";s.r(t);var r=s(197),i=s(199);t.default={hexColorReader:r.default,shortHeColorReader:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(198);const i=8,n=16,o=255,a="#",c=["red","green","blue"];t.default=class extends r.default{read(e){const t=parseInt(e.replace(a,""),n);return c.reduce((e,s,r,n)=>(e[s]=t>>i*(n.length-r-1)&o,e),{})}}},function(e,t,s){"use strict";s.r(t);t.default=class{read(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(198);const i=16,n=2,o="#",a=["red","green","blue"];t.default=class extends r.default{read(e){return e=e.replace(o,""),a.reduce((t,s,r)=>(t[s]=parseInt(e[r].repeat(n),i),t),{})}}},function(e,t,s){"use strict";s.r(t);var r=s(201),i=s(203);t.default={static:r.default,sprite:i.default}},function(e,t,s){"use strict";s.r(t);var r=s(202);t.default=class extends r.default{handle(e){return{x:e.x,y:e.y,width:e.width,height:e.height}}}},function(e,t,s){"use strict";s.r(t);t.default=class{handle(){throw new Error("You should override this function")}}},function(e,t,s){"use strict";s.r(t);var r=s(202);t.default=class extends r.default{handle(e,t){const{x:s,y:r,width:i,height:n}=e,{spacing:o,extruding:a,slice:c}=t,h=2*a,u=(i-(c-1)*o)/c-h,l=n-h;return{x:s+(u+o+h)*t.currentFrame+a,y:r+a,width:u,height:l}}}},function(e,t,s){"use strict";s.r(t);var r=s(205),i=s(206);const n="FRAGMENT_SHADER",o="VERTEX_SHADER",a={[n]:r.default,[o]:i.default};t.default=class{constructor(e){this.graphicContext=e,this.FRAGMENT_SHADER=n,this.VERTEX_SHADER=o,this.creators={[n]:this._createFragmentShader.bind(this),[o]:this._createVertexShader.bind(this)}}_createFragmentShader(){return this.graphicContext.createShader(this.graphicContext.FRAGMENT_SHADER)}_createVertexShader(){return this.graphicContext.createShader(this.graphicContext.VERTEX_SHADER)}create(e){const t=this.creators[e]();if(this.graphicContext.shaderSource(t,a[e]),this.graphicContext.compileShader(t),!this.graphicContext.getShaderParameter(t,this.graphicContext.COMPILE_STATUS)){const e=this.graphicContext.getShaderInfoLog(t);throw new Error(`An error occurred compiling the shaders: ${e}`)}return t}}},function(e,t,s){"use strict";s.r(t);t.default="\nprecision highp float;\n\nuniform sampler2D u_image;\nuniform vec2 u_texAtlasSize;\nuniform mat4 u_colorFilterMatrix;\n\nvarying vec2 v_texCoord;\nvarying vec2 v_texSize;\nvarying vec2 v_texTranslate;\nvarying vec2 v_gameObjectSize;\n\nfloat calculateCoord(float gameObjectSize, float texSize, float texTranslate, float texCoord) {\n  if (gameObjectSize > texSize) {\n    float repeat = gameObjectSize / texSize;\n    return mod(texCoord * repeat, texSize) + texTranslate;\n  } else {\n    return texCoord + texTranslate;\n  }\n}\n\nvoid main() {\n  vec2 texCoord = vec2(\n    calculateCoord(v_gameObjectSize.x, v_texSize.x, v_texTranslate.x, v_texCoord.x),\n    calculateCoord(v_gameObjectSize.y, v_texSize.y, v_texTranslate.y, v_texCoord.y)\n  );\n\n  gl_FragColor = u_colorFilterMatrix * texture2D(u_image, texCoord / u_texAtlasSize);\n}\n"},function(e,t,s){"use strict";s.r(t);t.default="\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nattribute mat3 a_modelViewMatrix;\n\nattribute vec2 a_texSize;\nattribute vec2 a_texTranslate;\nattribute vec2 a_gameObjectSize;\n\nuniform mat3 u_viewMatrix;\n\nvarying vec2 v_texCoord;\nvarying vec2 v_texSize;\nvarying vec2 v_texTranslate;\nvarying vec2 v_gameObjectSize;\n\nvoid main() {\n  mat3 matrix = u_viewMatrix * a_modelViewMatrix;\n  gl_Position = vec4((matrix * vec3(a_position, 1)).xy, 0, 1);\n\n  v_texCoord = a_texCoord;\n  v_texSize = a_texSize;\n  v_texTranslate = a_texTranslate;\n  v_gameObjectSize = a_gameObjectSize;\n}\n"},function(e,t,s){"use strict";s.r(t);t.default=class{getIdentityMatrix(){return[1,0,0,0,1,0,0,0,1]}project(e,t,s){const r=2/t,i=2/s;e[0]=e[0]*r,e[1]=-e[1]*i,e[3]=e[3]*r,e[4]=-e[4]*i,e[6]=e[6]*r,e[7]=-e[7]*i}translate(e,t,s){e[0]=e[0]+e[2]*t,e[1]=e[1]+e[2]*s,e[3]=e[3]+e[5]*t,e[4]=e[4]+e[5]*s,e[6]=e[6]+e[8]*t,e[7]=e[7]+e[8]*s}flipX(e){this.scale(e,-1,1)}flipY(e){this.scale(e,1,-1)}scale(e,t,s){e[0]=e[0]*t,e[1]=e[1]*s,e[3]=e[3]*t,e[4]=e[4]*s,e[6]=e[6]*t,e[7]=e[7]*s}rotate(e,t){t=t*Math.PI/180;const s=Math.cos(t),r=-Math.sin(t),i=e[0],n=e[3],o=e[6];e[0]=i*s+e[1]*r,e[1]=e[1]*s-i*r,e[3]=n*s+e[4]*r,e[4]=e[4]*s-n*r,e[6]=o*s+e[7]*r,e[7]=e[7]*s-o*r}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(209);t.default=class extends r.ProcessorPlugin{async load(e){const{store:t,dayLength:s,startTime:r}=e;return new i.default({store:t,dayLength:s,startTime:r})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(210);const n="timeOfDay",o="SET_COLOR_FILTER",a=[.4,0,.2,0,0,.4,.4,0,0,0,.4,0,0,0,0,1],c=[.5,0,0,0,0,.5,.4,0,0,0,.5,0,0,0,0,1],h=[.8,0,0,0,0,.8,0,0,0,0,.8,0,0,0,0,1],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=[1,0,0,0,.3,1,0,0,0,0,.7,0,0,0,0,1],d=[.8,0,0,0,.5,.8,0,0,0,0,.7,0,0,0,0,1];t.default=class extends r.Processor{constructor(e){super(),this._dayLength=e.dayLength,this._startTime=e.startTime,this._store=e.store,this._time=null,this._schedule=[a,c,h,u,u,u,l,d],this._currentFilterIndex=null}processorDidMount(){this._time=new i.default(this._dayLength,this._startTime),this._store.set(n,this._time)}_updateColorFilter(e){const t=this._time.getHours();Math.floor(t/3)!==this._currentFilterIndex&&(this._currentFilterIndex=Math.floor(t/3),e.send({type:o,filter:this._schedule[this._currentFilterIndex]}))}process(e){const{messageBus:t,deltaTime:s}=e;this._time.tick(s),this._updateColorFilter(t)}}},function(e,t,s){"use strict";s.r(t);const r=864e5;t.default=class{constructor(e,t){this._dayLength=e,this._startTime=t,this._factor=r/this._dayLength,this._currentTime=this._startTime/this._factor,this._days=0}tick(e){this._currentTime=this._currentTime+e,this._currentTime>=this._dayLength&&(this._days+=1),this._currentTime=this._currentTime%this._dayLength}getTotalSeconds(){return this.getTotalMilliseconds()/1e3}getTotalMilliseconds(){return this._currentTime*this._factor}getDays(){return this._days}getHours(){return Math.floor(this.getTotalMilliseconds()/36e5)}getMinutes(){return Math.floor(this.getTotalMilliseconds()%36e5/6e4)}getSeconds(){return Math.floor(this.getTotalMilliseconds()%6e4/1e3)}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(212);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectSpawner:e.gameObjectSpawner,gameObjectObserver:e.gameObjectObserver,store:e.store})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="transform",n="KILL",o=2e3,a=9,c=18,h=0,u=["healGrass","ogreGrass","boomGrass"],l="timeOfDay";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._gameObjectSpawner=e.gameObjectSpawner,this._store=e.store,this._islandSize={minX:-180,maxX:180,minY:-180,maxY:180},this._cooldown=0}process(e){const{messageBus:t,deltaTime:s}=e;if(this._cooldown>0)return void(this._cooldown-=s);const d=this._store.get(l).getHours();if(d>=a&&d<c){const e=r.MathOps.random(0,u.length-1),t=this._gameObjectSpawner.spawn(u[e]).getComponent(i);t.offsetX=r.MathOps.random(this._islandSize.minX,this._islandSize.maxX),t.offsetY=r.MathOps.random(this._islandSize.minY,this._islandSize.maxY),this._cooldown=o}this._gameObjectObserver.size()&&d>=h&&d<a&&this._gameObjectObserver.forEach(e=>{t.send({type:n,id:e.getId(),gameObject:e})})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(214);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver,store:e.store})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="COLLISION_ENTER",n="COLLISION_LEAVE",o="GRAB",a="KILL",c="canGrab",h="inventory",u="collectable";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._store=e.store,this._canGrab=new Set,this._inventory={}}processorDidMount(){this._store.set(c,this._canGrab),this._store.set(h,this._inventory)}process(e){const{messageBus:t}=e;this._gameObjectObserver.forEach(e=>{const s=e.getId();(t.getById(i,s)||[]).forEach(e=>{const{gameObject2:t}=e;t.getComponent(u)&&this._canGrab.add(t)}),(t.getById(n,s)||[]).forEach(e=>{const{gameObject2:t}=e;this._canGrab.has(t)&&this._canGrab.delete(t)}),(t.getById(o,s)||[]).forEach(()=>{if(!this._canGrab.size)return;const e=this._canGrab.values().next().value,s=e.getComponent(u);if(!s)return;const r=s.name;this._inventory[r]=this._inventory[r]||0,this._inventory[r]+=1,this._canGrab.delete(e),t.send({type:a,id:e.getId(),gameObject:e})})})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(216);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({store:e.store})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="CRAFT_RECIPE",n="inventory";t.default=class extends r.Processor{constructor(e){super(),this._store=e.store}process(e){const{messageBus:t}=e;(t.get(i)||[]).forEach(e=>{const{recipe:t}=e,s=this._store.get(n);!s[t.resource]||s[t.resource]<t.cost||(s[t.resource]-=t.cost,s[t.name]=s[t.name]||0,s[t.name]+=1)})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(218);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver,store:e.store})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const n="USE_ITEM",o="ADD_EFFECT",a="inventory",c={healPotion:{name:"heal",options:{value:50}},powerPotion:{name:"power",options:{damage:25,range:15}}};t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._store=e.store}process(e){const{messageBus:t}=e;this._gameObjectObserver.forEach(e=>{const s=e.getId();(t.getById(n,s)||[]).forEach(r=>{const{item:n}=r,h=this._store.get(a);h[n]&&(h[n]-=1,t.send(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),r.forEach(function(t){i(e,t,s[t])})}return e}({type:o,id:s,gameObject:e},c[n])))})})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(220);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);const i="MOVEMENT",n="transform",o="movement",a="viewDirection",c=.4,h=.5,u=1;t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver}process(e){const t=e.deltaTime/1e3,s=e.messageBus;this._gameObjectObserver.forEach(e=>{const l=e.getId(),{vector:d,speed:_,penalty:g}=e.getComponent(o);d.multiplyNumber(0);const f=s.getById(i,l)||[],{movementVector:p,intension:m}=f.reduce((e,t)=>{const{angle:s,x:i,y:n}=t;if(i&&n){const t=r.MathOps.getDistanceBetweenTwoPoints(0,i,0,n);e.intension=t<c?h:u}return e.movementVector.add(r.VectorOps.getVectorByAngle(r.MathOps.degToRad(s))),e},{movementVector:new r.Vector2(0,0),intension:1});if(!p||0===p.x&&0===p.y)return;const b=e.getComponent(n),v=g<_?_-g:0;p.multiplyNumber(v*t*(1/p.magnitude)*m),d.add(p),b.offsetX=b.offsetX+d.x,b.offsetY=b.offsetY+d.y;const O=e.getComponent(a);O.x=d.x,O.y=d.y})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(222);t.default=class extends r.ProcessorPlugin{async load(e){return new i.default({gameObjectObserver:e.gameObjectObserver})}}},function(e,t,s){"use strict";s.r(t);var r=s(1);function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const n="thumbStickControl",o="THUMB_STICK_POSITION_CHANGE";t.default=class extends r.Processor{constructor(e){super(),this._gameObjectObserver=e.gameObjectObserver,this._currentX=0,this._currentY=0,this._currentAngle=null}process(e){const t=e.messageBus;(t.get(o)||[]).forEach(e=>{const{x:t,y:s}=e;this._currentX=t,this._currentY=s,this._currentAngle=t||s?r.MathOps.radToDeg(r.MathOps.getAngleBetweenTwoPoints(t,0,s,0)):null}),null!==this._currentAngle&&this._gameObjectObserver.forEach(e=>{const s=e.getComponent(n).inputEventBindings[o];if(s){if(!s.messageType)throw new Error(`The message type not specified for input event: ${o}`);t.send(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),r.forEach(function(t){i(e,t,s[t])})}return e}({type:s.messageType},s.attrs,{gameObject:e,id:e.getId(),x:this._currentX,y:this._currentY,angle:this._currentAngle}))}})}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(224);t.default=class extends r.ProcessorPlugin{async load(){return new i.default}}},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(225);const n="MOUSE_INPUT_EVENT_QUERY";t.default=class extends r.Processor{constructor(){super(),this._isTouchDevice=Object(i.isTouchDevice)()}process(e){this._isTouchDevice&&e.messageBus.delete(n)}}},function(e,t,s){"use strict";s.r(t);var r=s(226);s.d(t,"isTouchDevice",function(){return r.isTouchDevice});var i=s(227);s.d(t,"getDisplayName",function(){return i.getDisplayName});var n=s(228);s.d(t,"isIosSafari",function(){return n.isIosSafari}),s.d(t,"isIos",function(){return n.isIos});var o=s(229);s.d(t,"applyIosSafariScreenFix",function(){return o.applyIosSafariScreenFix}),s.d(t,"applyIosChromeScreenFix",function(){return o.applyIosChromeScreenFix})},function(e,t,s){"use strict";s.r(t),s.d(t,"isTouchDevice",function(){return r});const r=()=>"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0},function(e,t,s){"use strict";s.r(t),s.d(t,"getDisplayName",function(){return r});const r=e=>e.displayName||e.name||"Component"},function(e,t,s){"use strict";s.r(t),s.d(t,"isIosSafari",function(){return r}),s.d(t,"isIos",function(){return i});const r=()=>"iphone"===navigator.platform.toLowerCase()&&navigator.userAgent.toLowerCase().includes("safari")&&!navigator.userAgent.toLowerCase().includes("crios")&&!navigator.userAgent.toLowerCase().includes("chrome"),i=()=>"iphone"===navigator.platform.toLowerCase()&&navigator.userAgent.toLowerCase().includes("safari")},function(e,t,s){"use strict";s.r(t),s.d(t,"applyIosSafariScreenFix",function(){return r}),s.d(t,"applyIosChromeScreenFix",function(){return i});const r=()=>{window.matchMedia("(orientation:landscape)").addEventListener("change",e=>{e.matches?(document.body.style.width=`${window.innerWidth}px`,document.body.style.height=`${window.innerHeight}px`):(document.body.style="",setTimeout(()=>{document.body.style.height=`${document.documentElement.clientHeight}px`,setTimeout(()=>{document.body.style=""},100)},500))})},i=()=>{document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&setTimeout(()=>window.dispatchEvent(new Event("resize")),500)})}},function(e,t,s){"use strict";s.r(t);var r=s(231),i=s(232),n=s(158),o=s(237),a=s(238),c=s(239),h=s(240),u=s(241),l=s(244),d=s(245),_=s(246),g=s(247);t.default={aimRadius:r.default,effect:i.Effect,activeEffects:n.ActiveEffects,health:o.default,hitBox:a.default,ai:c.default,collectable:h.default,weapon:u.default,thumbStickControl:l.default,movement:d.default,viewDirection:_.default,ui:g.UI}},function(e,t,s){"use strict";s.r(t);var r=s(1);class i extends r.Component{clone(){return new i}}t.default=i},function(e,t,s){"use strict";s.r(t),s.d(t,"Effect",function(){return o});var r=s(1),i=s(233);function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class o extends r.Component{constructor(e,t){super(e,t),this._action=t.action,this._type=t.type,this._options=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),r.forEach(function(t){n(e,t,s[t])})}return e}({},t.options);const s=i.applicatorOptions[this._type];s&&(this._applicatorOptions=new s(t.applicatorOptions))}set action(e){this._action=e}get action(){return this._action}set type(e){this._type=e}get type(){return this._type}set options(e){this._options=e}get options(){return this._options}set applicatorOptions(e){this._applicatorOptions=e}get applicatorOptions(){return this._applicatorOptions}clone(){return new o(this.componentName,{action:this.action,type:this.type,options:this.options,applicatorOptions:this.applicatorOptions})}}},function(e,t,s){"use strict";s.r(t),s.d(t,"applicatorOptions",function(){return o});var r=s(234),i=s(235),n=s(236);const o={delayed:r.DelayedEffectOptions,periodical:i.PeriodicalEffectOptions,timeLimited:n.TimeLimitedEffectOptions}},function(e,t,s){"use strict";s.r(t),s.d(t,"DelayedEffectOptions",function(){return r});class r{constructor(e){this._timer=e.timer}set timer(e){this._timer=e}get timer(){return this._timer}}},function(e,t,s){"use strict";s.r(t),s.d(t,"PeriodicalEffectOptions",function(){return r});class r{constructor(e){this._frequency=e.frequency,this._duration=e.duration,this._cooldown=e.frequency}set frequency(e){this._frequency=e}get frequency(){return this._frequency}set duration(e){this._duration=e}get duration(){return this._duration}set cooldown(e){this._cooldown=e}get cooldown(){return this._cooldown}}},function(e,t,s){"use strict";s.r(t),s.d(t,"TimeLimitedEffectOptions",function(){return r});class r{constructor(e){this._duration=e.duration}set duration(e){this._duration=e}get duration(){return this._duration}}},function(e,t,s){"use strict";s.r(t);var r=s(1);class i extends r.Component{constructor(e,t){super(e,t),this._points=t.points,this._maxPoints=t.points}set points(e){this._points=e}get points(){return this._points}set maxPoints(e){this._maxPoints=e}get maxPoints(){return this._maxPoints}clone(){return new i(this.componentName,{points:this.points,maxPoints:this.maxPoints})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(1);class i extends r.Component{clone(){return new i}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(1);class i extends r.Component{constructor(e,t){super(e,t),this._strategy=t.strategy}set strategy(e){this._strategy=e}get strategy(){return this._strategy}clone(){return new i(this.componentName,{strategy:this.strategy})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(1);class i extends r.Component{constructor(e,t){super(e,t),this._name=t.name}set name(e){this._name=e}get name(){return this._name}clone(){return new i(this.componentName,{name:this.name})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(1),i=s(242),n=s(243);class o extends r.Component{constructor(e,t){if(super(e,t),this._weapons={melee:i.default,range:n.default},this._type=t.type,this._cooldown=t.cooldown,this._cooldownRemaining=0,!this._weapons[this.type])throw new Error(`Not found weapon with same type: ${this.type}`);this._properties=new this._weapons[this.type](t.properties)}set type(e){this._type=e}get type(){return this._type}set cooldown(e){this._cooldown=e}get cooldown(){return this._cooldown}set properties(e){this._properties=e}get properties(){return this._properties}set cooldownRemaining(e){this._cooldownRemaining=e}get cooldownRemaining(){return this._cooldownRemaining}clone(){return new o(this.componentName,{type:this.type,cooldown:this.cooldown,properties:this.properties.clone()})}}t.default=o},function(e,t,s){"use strict";s.r(t);class r{constructor(e){this._damage=e.damage,this._range=e.range}set damage(e){this._damage=e}get damage(){return this._damage}set range(e){this._range=e}get range(){return this._range}clone(){return new r({damage:this.damage,range:this.range})}}t.default=r},function(e,t,s){"use strict";s.r(t);class r{constructor(e){this._damage=e.damage,this._range=e.range,this._projectileSpeed=e.projectileSpeed,this._projectileModel=e.projectileModel,this._projectileRadius=e.projectileRadius}set damage(e){this._damage=e}get damage(){return this._damage}set range(e){this._range=e}get range(){return this._range}set projectileSpeed(e){this._projectileSpeed=e}get projectileSpeed(){return this._projectileSpeed}set projectileModel(e){this._projectileModel=e}get projectileModel(){return this._projectileModel}set projectileRadius(e){this._projectileRadius=e}get projectileRadius(){return this._projectileRadius}clone(){return new r({damage:this.damage,range:this.range,projectileSpeed:this.projectileSpeed,projectileModel:this.projectileModel,projectileRadius:this.projectileRadius})}}t.default=r},function(e,t,s){"use strict";s.r(t);var r=s(1);function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n extends r.Component{constructor(e,t){super(e,t),this._inputEventBindings=t.inputEventBindings}set inputEventBindings(e){this._inputEventBindings=e}get inputEventBindings(){return this._inputEventBindings}clone(){return new n(this.componentName,{inputEventBindings:function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable}))),r.forEach(function(t){i(e,t,s[t])})}return e}({},this.inputEventBindings)})}}t.default=n},function(e,t,s){"use strict";s.r(t);var r=s(1);class i extends r.Component{constructor(e,t){super(e,t),this._speed=t.speed,this._vector=new r.Vector2(0,0),this._penalty=0}set speed(e){this._speed=e}get speed(){return this._speed}set vector(e){this._vector=e}get vector(){return this._vector}set penalty(e){this._penalty=e}get penalty(){return this._penalty}clone(){return new i(this.componentName,{speed:this.speed})}}t.default=i},function(e,t,s){"use strict";s.r(t);var r=s(1);class i extends r.Component{constructor(e,t){super(e,t),this._x=t.x,this._y=t.y}set x(e){this._x=e}get x(){return this._x}set y(e){this._y=e}get y(){return this._y}clone(){return new i(this.componentName,{x:this.x,y:this.y})}}t.default=i},function(e,t,s){"use strict";s.r(t),s.d(t,"UI",function(){return i});var r=s(1);class i extends r.Component{constructor(e,t){super(e,t),this._icon=t.icon,this._title=t.title}set icon(e){this._icon=e}get icon(){return this._icon}set title(e){this._title=e}get title(){return this._title}clone(){return new i(this.componentName,{icon:this.icon,title:this.title})}}},function(e,t,s){"use strict";s.r(t);var r=s(249),i=s(250),n=s(251);t.default={loadUiApp:r.default,loadScripts:i.default,loadEffects:n.default}},function(e,t,s){"use strict";function r(){return Promise.all([s.e(2),s.e(1)]).then(s.bind(null,252))}s.r(t),s.d(t,"default",function(){return r})},function(e,t,s){"use strict";function r(){return s.e(3).then(s.bind(null,374))}s.r(t),s.d(t,"default",function(){return r})},function(e,t,s){"use strict";function r(){return s.e(4).then(s.bind(null,375))}s.r(t),s.d(t,"default",function(){return r})}]);